<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.0" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.11" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://mister-hope.github.io/lzc-blog.github.io/knowledge/01-Java/03-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA.html"><meta property="og:site_name" content="lzcçš„åšå®¢"><meta property="og:title" content="03-JVM"><meta property="og:description" content="03-JVM çµé­‚ä¸‰é—®ï¼š JVMæ˜¯ä»€ä¹ˆï¼Ÿ JVMå¹¿ä¹‰ä¸ŠæŒ‡çš„æ˜¯ä¸€ç§è§„èŒƒã€‚ç‹­ä¹‰ä¸Šçš„æ˜¯JDKä¸­çš„JVMè™šæ‹Ÿæœºã€‚ ä¸ºä»€ä¹ˆè¦å­¦ä¹ JVMï¼Ÿ é¢è¯•è¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šè¢«é—®åˆ°JVMã€‚ ç ”å‘è¿‡ç¨‹ä¸­ï¼Œè‚¯å®šä¼šé¢ä¸´ä¸€äº›é‡éš¾ç‚¹é—®é¢˜ä¸JVMæœ‰å…³ç³»ã€‚ä¾‹å¦‚ï¼šçº¿ç¨‹æ­»é”ã€å†…å­˜æº¢å‡ºã€é¡¹ç›®æ€§èƒ½ä¼˜åŒ–ç­‰ç­‰ã€‚ åŸºç¡€ä¸ç‰¢ï¼Œåœ°åŠ¨å±±æ‘‡ã€‚æƒ³æ·±å…¥æŒæ¡Javaè¿™é—¨è¯­è¨€ï¼ŒJVMå§‹ç»ˆæ˜¯ç»•ä¸è¿‡å»çš„é‚£åº§å¤§å±±ï¼Œæ—©æ™šå¾—æ”€ã€‚"><meta property="og:type" content="article"><meta property="og:image" content="https://mister-hope.github.io/lzc-blog.github.io/assets/images/cover1.jpg"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2024-01-11T20:00:46.000Z"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:alt" content="03-JVM"><meta property="article:author" content="Mr.Lzc"><meta property="article:modified_time" content="2024-01-11T20:00:46.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"03-JVM","image":["https://mister-hope.github.io/lzc-blog.github.io/assets/images/cover1.jpg"],"dateModified":"2024-01-11T20:00:46.000Z","author":[{"@type":"Person","name":"Mr.Lzc","url":"https://mister-hope.com"}]}</script><link rel="icon" href="http://wx.qlogo.cn/mmopen/hq5eSuP936UuicLNJoPk3v5ksFoeq51J9yI6uF6QtLpfVewy63EIgnceVFFW8BD3uAUXTrrQlQ8AV6JZRJHib4iansmlqIoUznO/64"><title>03-JVM | lzcçš„åšå®¢</title><meta name="description" content="03-JVM çµé­‚ä¸‰é—®ï¼š JVMæ˜¯ä»€ä¹ˆï¼Ÿ JVMå¹¿ä¹‰ä¸ŠæŒ‡çš„æ˜¯ä¸€ç§è§„èŒƒã€‚ç‹­ä¹‰ä¸Šçš„æ˜¯JDKä¸­çš„JVMè™šæ‹Ÿæœºã€‚ ä¸ºä»€ä¹ˆè¦å­¦ä¹ JVMï¼Ÿ é¢è¯•è¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šè¢«é—®åˆ°JVMã€‚ ç ”å‘è¿‡ç¨‹ä¸­ï¼Œè‚¯å®šä¼šé¢ä¸´ä¸€äº›é‡éš¾ç‚¹é—®é¢˜ä¸JVMæœ‰å…³ç³»ã€‚ä¾‹å¦‚ï¼šçº¿ç¨‹æ­»é”ã€å†…å­˜æº¢å‡ºã€é¡¹ç›®æ€§èƒ½ä¼˜åŒ–ç­‰ç­‰ã€‚ åŸºç¡€ä¸ç‰¢ï¼Œåœ°åŠ¨å±±æ‘‡ã€‚æƒ³æ·±å…¥æŒæ¡Javaè¿™é—¨è¯­è¨€ï¼ŒJVMå§‹ç»ˆæ˜¯ç»•ä¸è¿‡å»çš„é‚£åº§å¤§å±±ï¼Œæ—©æ™šå¾—æ”€ã€‚">
    <link rel="preload" href="/lzc-blog.github.io/assets/style-nGKLiz7R.css" as="style"><link rel="stylesheet" href="/lzc-blog.github.io/assets/style-nGKLiz7R.css">
    <link rel="modulepreload" href="/lzc-blog.github.io/assets/app-R2Im2jFX.js"><link rel="modulepreload" href="/lzc-blog.github.io/assets/03-JVMè™šæ‹Ÿæœº.html-rpvyw1qf.js"><link rel="modulepreload" href="/lzc-blog.github.io/assets/03-JVMè™šæ‹Ÿæœº.html-37vtSs4A.js"><link rel="modulepreload" href="/lzc-blog.github.io/assets/plugin-vue_export-helper-x3n3nnut.js">
    <link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-rSNIY_ZU.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/intro.html-nFvKLTkX.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-FL4G-uQm.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/disable.html-7Wj7tYAp.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/encrypt.html-daFnVj5l.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/icon.html-Slcn3ETP.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/layout.html-PvU90oKX.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/markdown.html-MtGSv1A-.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/page.html-qs2bs6AX.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-bK4B_Udp.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/01-JavaåŸºç¡€éƒ¨åˆ†.html-k1VTvAND.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/06-å¹¶å‘ç¼–ç¨‹.html-2j89IEgf.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-3P4UKaSi.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/01-å‰ç«¯.html-VUYs2MOa.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-xd4vuOWx.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/è®¡ç®—æœº.html-lB3dRPzn.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/2024-01-09é—®é¢˜.html-UzTBgPV2.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-zNkLKdGu.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/test.html-zPULBdp7.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/cao.html-kdin7Mw3.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/å­¦ä¹ æ€è·¯.html-lCH1n_af.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/ç”Ÿæ´»æ„Ÿæ‚Ÿ.html-VGMtbE66.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/2024011.html-XyMbliQS.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/TiDB.html-_3IOHP8p.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/404.html-awZNNLii.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-NmnKsVNi.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-eTnrvdhb.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-1gCfoEoi.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-Wwl1AJ2I.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-Ppk8JpKL.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-yF9UJbkL.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-r7BUml9S.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-szP-rr-e.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-3Z3lcjRJ.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-PwvHWcNZ.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-ZNAY6PpX.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-BV_VJzji.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-uuZO7wo7.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-g9M6yJsQ.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-Em-XmVde.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-TXfvnYLJ.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-vDQUYdy1.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-C6DhxVWX.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-HUanOdJg.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-bhCMsGHr.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-DyPxQFqk.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html--9V62bSj.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-wt-gvt2T.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-eG_a2lQc.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-_MUr2JXh.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-kQL3uEVN.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-w_aKY_42.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-K3MoY7Nr.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-ywN6JbyE.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/intro.html-O60P_WRF.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-EdKpcG2x.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/disable.html-Mu9ao7Xl.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/encrypt.html-hvIQ9Csr.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/icon.html-wnfY0xpv.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/layout.html-PCSCuXvw.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/markdown.html-1mfceB-N.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/page.html-bDCr3Z9f.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-SDeehvaK.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/01-JavaåŸºç¡€éƒ¨åˆ†.html-BMvTD2J6.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/06-å¹¶å‘ç¼–ç¨‹.html-lWkcfM8j.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-KMpIkMPH.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/01-å‰ç«¯.html-gLd0NiR8.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-f2A8zvzW.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/è®¡ç®—æœº.html-4ybHJHtQ.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/2024-01-09é—®é¢˜.html-dtI5y0M7.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-2BKOFk7A.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/test.html-iLUwp2-j.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/cao.html-pZb7s_Ky.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/å­¦ä¹ æ€è·¯.html-dfeuuX4Y.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/ç”Ÿæ´»æ„Ÿæ‚Ÿ.html-MMdFe9bh.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/2024011.html-dOmrcpjX.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/TiDB.html-mBoB-35E.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/404.html-rMODLEps.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-Aen3QtrY.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-UmTzcUiB.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-j-w8gN0U.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-jP_YtQUM.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-7ToRc_Os.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-TloqJ35J.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-zco9kZeg.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-SvJFUauC.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-Qs5qimpZ.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-NvUmxEVu.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html--pjUP0GS.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-_EO92twS.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-FapW9pNB.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-Z6OAgN-1.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-vDR15KOQ.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-4tS0uMEh.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-7RE13lCb.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-mUyOKKrY.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-vHDJaa-Y.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-rhfVppXx.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-YfI2HwOL.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-B_3PKsuF.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-zaoqEY7r.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-8lBagjx9.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-xf_tmjl9.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-MsbURGgu.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-6NBxTMUY.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/index.html-rZsoPRBK.js" as="script"><link rel="prefetch" href="/lzc-blog.github.io/assets/photoswipe.esm-08_zHRDQ.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="vp-link vp-brand vp-brand" href="/lzc-blog.github.io/"><img class="vp-nav-logo" src="http://wx.qlogo.cn/mmopen/hq5eSuP936UuicLNJoPk3v5ksFoeq51J9yI6uF6QtLpfVewy63EIgnceVFFW8BD3uAUXTrrQlQ8AV6JZRJHib4iansmlqIoUznO/64" alt><!----><span class="vp-site-name hide-in-pad">lzcçš„åšå®¢</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a aria-label="åšå®¢ä¸»é¡µ" class="vp-link nav-link nav-link" href="/lzc-blog.github.io/"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>åšå®¢ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="éšç¬”"><span class="title"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>éšç¬”</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>ä»£ç å¿ƒå¾—</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a aria-label="æ€è·¯" class="vp-link nav-link nav-link" href="/lzc-blog.github.io/%E9%9A%8F%E7%AC%94/%E6%83%B3%E6%B3%95/%E5%AD%A6%E4%B9%A0%E6%80%9D%E8%B7%AF.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>æ€è·¯<!----></a></li><li class="dropdown-subitem"><a aria-label="çªå¦‚å…¶æ¥çš„æ„Ÿæƒ³" class="vp-link nav-link nav-link" href="/lzc-blog.github.io/%E9%9A%8F%E7%AC%94/%E6%83%B3%E6%B3%95/cao.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>çªå¦‚å…¶æ¥çš„æ„Ÿæƒ³<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>å·¥ä½œéšç¬”</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a aria-label="æµ‹è¯•" class="vp-link nav-link nav-link" href="/lzc-blog.github.io/%E9%9A%8F%E7%AC%94/%E5%B7%A5%E4%BD%9C/test.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>æµ‹è¯•<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>ç”Ÿæ´»éšç¬”</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a aria-label="æ„Ÿæ‚Ÿ" class="vp-link nav-link nav-link" href="/lzc-blog.github.io/%E9%9A%8F%E7%AC%94/%E7%94%9F%E6%B4%BB/%E7%94%9F%E6%B4%BB%E6%84%9F%E6%82%9F.html"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>æ„Ÿæ‚Ÿ<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a aria-label="çŸ¥è¯†ç¬”è®°å½’æ¡£ç›®å½•" class="vp-link nav-link active nav-link active" href="/lzc-blog.github.io/knowledge.html"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span>çŸ¥è¯†ç¬”è®°å½’æ¡£ç›®å½•<!----></a></div><div class="nav-item hide-in-mobile"><a aria-label="ä¸»è¦åŠŸèƒ½ä¸é…ç½®æ¼”ç¤º" class="vp-link nav-link nav-link" href="/lzc-blog.github.io/demo.html"><span class="font-icon icon fa-fw fa-sm fas fa-white_large_square" style=""></span>ä¸»è¦åŠŸèƒ½ä¸é…ç½®æ¼”ç¤º<!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><!----><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><p class="vp-sidebar-heading active"><!----><span class="vp-sidebar-title">çŸ¥è¯†ç¬”è®°å½’æ¡£</span><!----></p><ul class="vp-sidebar-links"><li><!--[--><a aria-label="çŸ¥è¯†ç¬”è®°å½’æ¡£ç›®å½•" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/lzc-blog.github.io/knowledge/"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span>çŸ¥è¯†ç¬”è®°å½’æ¡£ç›®å½•<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable active" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-object-group" style=""></span><span class="vp-sidebar-title">01-JavaçŸ¥è¯†</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><!--[--><a aria-label="01-JavaåŸºç¡€" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/lzc-blog.github.io/knowledge/01-Java/01-Java%E5%9F%BA%E7%A1%80%E9%83%A8%E5%88%86.html"><!---->01-JavaåŸºç¡€<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="03-JVM" class="vp-link nav-link active vp-sidebar-link vp-sidebar-page active nav-link active vp-sidebar-link vp-sidebar-page active" href="/lzc-blog.github.io/knowledge/01-Java/03-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA.html"><!---->03-JVM<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="1. JVMè™šæ‹Ÿæœºæ¦‚è¿°" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/lzc-blog.github.io/knowledge/01-Java/03-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA.html#_1-jvmè™šæ‹Ÿæœºæ¦‚è¿°"><!---->1. JVMè™šæ‹Ÿæœºæ¦‚è¿°<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="1.1 JVM åŸºæœ¬å¸¸è¯†" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/lzc-blog.github.io/knowledge/01-Java/03-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA.html#_1-1-jvm-åŸºæœ¬å¸¸è¯†"><!---->1.1 JVM åŸºæœ¬å¸¸è¯†<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="1.2 ç±»åŠ è½½å­ç³»ç»Ÿ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/lzc-blog.github.io/knowledge/01-Java/03-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA.html#_1-2-ç±»åŠ è½½å­ç³»ç»Ÿ"><!---->1.2 ç±»åŠ è½½å­ç³»ç»Ÿ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="1.3 è¿è¡Œæ—¶æ•°æ®åŒº" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/lzc-blog.github.io/knowledge/01-Java/03-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA.html#_1-3-è¿è¡Œæ—¶æ•°æ®åŒº"><!---->1.3 è¿è¡Œæ—¶æ•°æ®åŒº<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="01-JVMåŸºæœ¬å¸¸è¯†" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/lzc-blog.github.io/knowledge/01-Java/03-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA.html#_01-jvmåŸºæœ¬å¸¸è¯†"><!---->01-JVMåŸºæœ¬å¸¸è¯†<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="02-ç±»åŠ è½½å­ç³»ç»Ÿ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/lzc-blog.github.io/knowledge/01-Java/03-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA.html#_02-ç±»åŠ è½½å­ç³»ç»Ÿ"><!---->02-ç±»åŠ è½½å­ç³»ç»Ÿ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="03-è¿è¡Œæ—¶æ•°æ®åŒº" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/lzc-blog.github.io/knowledge/01-Java/03-JVM%E8%99%9A%E6%8B%9F%E6%9C%BA.html#_03-è¿è¡Œæ—¶æ•°æ®åŒº"><!---->03-è¿è¡Œæ—¶æ•°æ®åŒº<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a aria-label="06-å¹¶å‘ç¼–ç¨‹" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/lzc-blog.github.io/knowledge/01-Java/06-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B.html"><!---->06-å¹¶å‘ç¼–ç¨‹<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><span class="font-icon icon fa-fw fa-sm fas fa-object-group" style=""></span><span class="vp-sidebar-title">02-å‰ç«¯ç›¸å…³</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">03 æ•°æ®åº“</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">04 è®¡ç®—æœºåŸºç¡€</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><!----><span class="vp-sidebar-title">æ‚è®°ç›®å½•</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!--[--><!----><!--]--><div class="page-cover"><img src="/lzc-blog.github.io/assets/images/cover1.jpg" alt no-view></div><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->03-JVM</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://mister-hope.com" target="_blank" rel="noopener noreferrer">Mr.Lzc</a></span><span property="author" content="Mr.Lzc"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2024-01-11T20:00:46.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 31 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT31M"></span><!----><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_1-jvmè™šæ‹Ÿæœºæ¦‚è¿°">1. JVMè™šæ‹Ÿæœºæ¦‚è¿°</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_1-1-jvm-åŸºæœ¬å¸¸è¯†">1.1 JVM åŸºæœ¬å¸¸è¯†</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_1-2-ç±»åŠ è½½å­ç³»ç»Ÿ">1.2 ç±»åŠ è½½å­ç³»ç»Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#_1-3-è¿è¡Œæ—¶æ•°æ®åŒº">1.3 è¿è¡Œæ—¶æ•°æ®åŒº</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_01-jvmåŸºæœ¬å¸¸è¯†">01-JVMåŸºæœ¬å¸¸è¯†</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_02-ç±»åŠ è½½å­ç³»ç»Ÿ">02-ç±»åŠ è½½å­ç³»ç»Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#_03-è¿è¡Œæ—¶æ•°æ®åŒº">03-è¿è¡Œæ—¶æ•°æ®åŒº</a></li><!----><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!--[--><!----><!--]--><div class="theme-hope-content"><h1 id="_03-jvm" tabindex="-1"><a class="header-anchor" href="#_03-jvm" aria-hidden="true">#</a> 03-JVM</h1><p><strong>çµé­‚ä¸‰é—®ï¼š</strong></p><p><strong>JVMæ˜¯ä»€ä¹ˆï¼Ÿ</strong></p><ul><li>JVMå¹¿ä¹‰ä¸ŠæŒ‡çš„æ˜¯ä¸€ç§è§„èŒƒã€‚ç‹­ä¹‰ä¸Šçš„æ˜¯JDKä¸­çš„JVMè™šæ‹Ÿæœºã€‚</li></ul><p><strong>ä¸ºä»€ä¹ˆè¦å­¦ä¹ JVMï¼Ÿ</strong></p><ul><li>é¢è¯•è¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šè¢«é—®åˆ°JVMã€‚</li><li>ç ”å‘è¿‡ç¨‹ä¸­ï¼Œè‚¯å®šä¼šé¢ä¸´ä¸€äº›é‡éš¾ç‚¹é—®é¢˜ä¸JVMæœ‰å…³ç³»ã€‚ä¾‹å¦‚ï¼šçº¿ç¨‹æ­»é”ã€å†…å­˜æº¢å‡ºã€é¡¹ç›®æ€§èƒ½ä¼˜åŒ–ç­‰ç­‰ã€‚</li><li>åŸºç¡€ä¸ç‰¢ï¼Œåœ°åŠ¨å±±æ‘‡ã€‚æƒ³æ·±å…¥æŒæ¡Javaè¿™é—¨è¯­è¨€ï¼ŒJVMå§‹ç»ˆæ˜¯ç»•ä¸è¿‡å»çš„é‚£åº§å¤§å±±ï¼Œæ—©æ™šå¾—æ”€ã€‚</li></ul><p><strong>æ€ä¹ˆå­¦ä¹ JVMï¼Ÿ</strong></p><p>JVMè™šæ‹Ÿæœºéƒ¨åˆ†ï¼Œæˆ‘ä»¬æ˜¯è¿™ä¹ˆå®‰æ’çš„ï¼š</p><ol><li>JVMåŸºæœ¬å¸¸è¯†</li><li>ç±»åŠ è½½å­ç³»ç»Ÿ</li><li>è¿è¡Œæ—¶æ•°æ®åŒº</li><li>ä¸€ä¸ªå¯¹è±¡çš„ä¸€ç”Ÿï¼ˆå‡ºç”Ÿã€æ­»äº¡ä¸å†…æ¶µï¼‰</li><li>GCåƒåœ¾æ”¶é›†å™¨</li><li>JVMè°ƒä¼˜ç›¸å…³å·¥å…·ä¸å¯è°ƒå‚æ•°</li><li>è°ƒä¼˜å®æˆ˜æ¡ˆä¾‹</li></ol><h2 id="_1-jvmè™šæ‹Ÿæœºæ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#_1-jvmè™šæ‹Ÿæœºæ¦‚è¿°" aria-hidden="true">#</a> 1. JVMè™šæ‹Ÿæœºæ¦‚è¿°</h2><h3 id="_1-1-jvm-åŸºæœ¬å¸¸è¯†" tabindex="-1"><a class="header-anchor" href="#_1-1-jvm-åŸºæœ¬å¸¸è¯†" aria-hidden="true">#</a> 1.1 JVM åŸºæœ¬å¸¸è¯†</h3><h4 id="ä»€ä¹ˆæ˜¯jvm" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯jvm" aria-hidden="true">#</a> ä»€ä¹ˆæ˜¯JVMï¼Ÿ</h4><p>å¹³æ—¶æˆ‘ä»¬æ‰€è¯´çš„JVMå¹¿ä¹‰ä¸ŠæŒ‡çš„æ˜¯ä¸€ç§è§„èŒƒã€‚ç‹­ä¹‰ä¸Šçš„æ˜¯JDKä¸­çš„JVMè™šæ‹Ÿæœºã€‚JVMçš„å®ç°æ˜¯ç”±å„ä¸ªå‚å•†æ¥åšçš„ã€‚æ¯”å¦‚ç°åœ¨æµä¼ æœ€å¹¿æ³›çš„æ˜¯hotspotã€‚å…¶ä»–å®ç°ï¼šBEAå…¬å¸ JRocketã€IBM j9ã€zing å·ç§°ä¸–ç•Œæœ€å¿«JVMã€taobao.vmã€‚ä»å¹¿ä¹‰ä¸Šè®²Javaï¼ŒKotlinã€Clojureã€JRubyã€Groovyç­‰è¿è¡ŒäºJavaè™šæ‹Ÿæœºä¸Šçš„ç¼–ç¨‹è¯­è¨€åŠå…¶ç›¸å…³çš„ç¨‹åºéƒ½å±äºJavaæŠ€æœ¯ä½“ç³»ä¸­çš„ä¸€å‘˜ã€‚</p><p>JavaæŠ€æœ¯ä½“ç³»ä¸»è¦åŒ…æ‹¬å¦‚ä¸‹å››ä¸ªæ–¹é¢ã€‚</p><ul><li>Javaç¨‹åºè®¾è®¡è¯­è¨€</li><li>Javaç±»åº“API</li><li>æ¥è‡ªå•†ä¸šæœºæ„å’Œå¼€æºç¤¾åŒºçš„ç¬¬ä¸‰æ–¹Javaç±»åº“ <ul><li>Google</li><li>Apache</li><li>ç­‰ç­‰</li></ul></li><li><strong>Javaè™šæ‹Ÿæœºï¼šå„ç§ç¡¬ä»¶å¹³å°ä¸Šçš„Javaè™šæ‹Ÿæœºå®ç°</strong></li></ul><figure><img src="/lzc-blog.github.io/assets/æœªæ ‡é¢˜-10-10-166134013926198-FJ9zgl_o.jpg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>å¯ä»¥ç®€å•ç±»æ¯”ä¸€ä¸‹ï¼šJavaè™šæ‹Ÿæœºæ˜¯å®¿ä¸»ï¼ŒJavaä»£ç å¼€å‘çš„ç¨‹åºåˆ™å¯„ç”Ÿåœ¨å®¿ä¸»ä¸Šï¼</p><h4 id="jvmæ¶æ„å›¾" tabindex="-1"><a class="header-anchor" href="#jvmæ¶æ„å›¾" aria-hidden="true">#</a> JVMæ¶æ„å›¾</h4><figure><img src="/lzc-blog.github.io/assets/4algenk2om-tkq3b84G.jpg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>Javaå’ŒJVMçš„å…³ç³»ï¼š</p><figure><img src="/lzc-blog.github.io/assets/lgbn0xav9h-8xusCZNI.jpg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h3 id="_1-2-ç±»åŠ è½½å­ç³»ç»Ÿ" tabindex="-1"><a class="header-anchor" href="#_1-2-ç±»åŠ è½½å­ç³»ç»Ÿ" aria-hidden="true">#</a> 1.2 ç±»åŠ è½½å­ç³»ç»Ÿ</h3><h4 id="_1-2-1-ç±»åŠ è½½çš„æ—¶æœº" tabindex="-1"><a class="header-anchor" href="#_1-2-1-ç±»åŠ è½½çš„æ—¶æœº" aria-hidden="true">#</a> 1.2.1 ç±»åŠ è½½çš„æ—¶æœº</h4><p>ç±»åŠ è½½ä¸»è¦æœ‰å››ä¸ªæ—¶æœºï¼š</p><ol><li>é‡åˆ°<code>new</code>ã€<code>getstatic</code>ã€<code>putstatic</code>å’Œ<code>invokestatic</code>è¿™å››æ¡æŒ‡ä»¤æ—¶ï¼Œå¦‚æœå¯¹åº”çš„ç±»æ²¡æœ‰åˆå§‹åŒ–ï¼Œåˆ™è¦å¯¹å¯¹åº”çš„ç±»å…ˆè¿›è¡Œåˆå§‹åŒ–ã€‚</li></ol><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Student</span><span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> age <span class="token punctuation">;</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">method</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//Student.age</span>
<span class="token comment">//Student.method();</span>
<span class="token comment">//new Student();</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>ä½¿ç”¨<code>java.lang.reflect</code>åŒ…æ–¹æ³•æ—¶ï¼Œå¯¹ç±»è¿›è¡Œ<strong>åå°„è°ƒç”¨</strong>çš„æ—¶å€™ã€‚</li></ol><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">Class</span> c <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forname</span><span class="token punctuation">(</span><span class="token string">&quot;com.hero.Student&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="3"><li>åˆå§‹åŒ–ä¸€ä¸ªç±»çš„æ—¶å€™å‘ç°å…¶çˆ¶ç±»è¿˜æ²¡åˆå§‹åŒ–ï¼Œè¦å…ˆåˆå§‹åŒ–å…¶çˆ¶ç±»</li><li>å½“è™šæ‹Ÿæœºå¼€å§‹å¯åŠ¨æ—¶ï¼Œç”¨æˆ·éœ€è¦æŒ‡å®šä¸€ä¸ªä¸»ç±»ï¼ˆmainï¼‰ï¼Œè™šæ‹Ÿæœºä¼šå…ˆæ‰§è¡Œè¿™ä¸ªä¸»ç±»çš„åˆå§‹åŒ–ã€‚</li></ol><h4 id="_1-2-2-ç±»åŠ è½½çš„è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#_1-2-2-ç±»åŠ è½½çš„è¿‡ç¨‹" aria-hidden="true">#</a> 1.2.2 ç±»åŠ è½½çš„è¿‡ç¨‹</h4><p><strong>ç±»åŠ è½½ä¸»è¦åšä¸‰ä»¶äº‹ï¼š</strong></p><ol><li>å…¨é™å®šåç§° ==&gt; äºŒè¿›åˆ¶å­—èŠ‚æµåŠ è½½classæ–‡ä»¶</li><li>å­—èŠ‚æµçš„é™æ€æ•°æ®ç»“æ„ ==&gt; æ–¹æ³•åŒºçš„è¿è¡Œæ—¶æ•°æ®ç»“æ„</li><li>åˆ›å»ºå­—èŠ‚ç Classå¯¹è±¡</li></ol><p><strong>ä¸€ä¸ªç±»çš„ä¸€ç”Ÿï¼š</strong></p><figure><img src="/lzc-blog.github.io/assets/80y_1yxgql-HKorxRjq.jpg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>å¯ä»¥ä»å“ªäº›é€”å¾„åŠ è½½å­—èŠ‚ç ï¼Ÿ</p><figure><img src="/lzc-blog.github.io/assets/x0huy5-77d-1704122464182-T_Je9KPY.jpg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h4 id="_1-2-3-ç±»åŠ è½½å™¨" tabindex="-1"><a class="header-anchor" href="#_1-2-3-ç±»åŠ è½½å™¨" aria-hidden="true">#</a> 1.2.3 ç±»åŠ è½½å™¨</h4><p><strong>JVMçš„ç±»åŠ è½½æ˜¯é€šè¿‡ClassLoaderåŠå…¶å­ç±»æ¥å®Œæˆçš„ã€‚</strong></p><figure><img src="/lzc-blog.github.io/assets/e41kjw6__4-PWSKu3lP.jpg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><ul><li><strong>æ£€æŸ¥é¡ºåºæ˜¯è‡ªåº•å‘ä¸Š</strong>ï¼šåŠ è½½è¿‡ç¨‹ä¸­ä¼šå…ˆæ£€æŸ¥ç±»æ˜¯å¦è¢«å·²åŠ è½½ï¼Œä»Custom ClassLoaderåˆ°BootStrap ClassLoaderé€å±‚æ£€æŸ¥ï¼Œåªè¦æŸä¸ªclassloaderå·²åŠ è½½å°±è§†ä¸ºå·²åŠ è½½æ­¤ç±»ï¼Œä¿è¯æ­¤ç±»åªæ‰€æœ‰ClassLoaderåŠ è½½ä¸€æ¬¡ã€‚</li><li><strong>åŠ è½½çš„é¡ºåºæ˜¯è‡ªé¡¶å‘ä¸‹</strong>ï¼šä¹Ÿå°±æ˜¯ç”±ä¸Šå±‚æ¥é€å±‚å°è¯•åŠ è½½æ­¤ç±»ã€‚</li></ul><figure><img src="/lzc-blog.github.io/assets/51_0p6idsb-CF6Ae5pR.jpg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><ul><li><strong>å¯åŠ¨ç±»åŠ è½½å™¨(Bootstrap ClassLoader)</strong>ï¼š <ul><li>è´Ÿè´£åŠ è½½ JAVA_HOME\lib ç›®å½•ä¸­çš„ï¼Œæˆ–é€šè¿‡-Xbootclasspathå‚æ•°æŒ‡å®šè·¯å¾„ä¸­çš„ï¼Œä¸”è¢«è™šæ‹Ÿæœºè®¤å¯ï¼ˆæŒ‰æ–‡ä»¶åè¯†åˆ«ï¼Œå¦‚rt.jarï¼‰çš„ç±»ã€‚ç”±C++å®ç°ï¼Œä¸æ˜¯ClassLoaderçš„å­ç±»</li></ul></li><li><strong>æ‰©å±•ç±»åŠ è½½å™¨(Extension ClassLoader)</strong>ï¼š <ul><li>è´Ÿè´£åŠ è½½ JAVA_HOME\lib\ext ç›®å½•ä¸­çš„ï¼Œæˆ–é€šè¿‡java.ext.dirsç³»ç»Ÿå˜é‡æŒ‡å®šè·¯å¾„ä¸­çš„ç±»åº“ã€‚</li></ul></li><li><strong>åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨(Application ClassLoader)</strong>ï¼š <ul><li>è´Ÿè´£åŠ è½½ç”¨æˆ·è·¯å¾„classpathä¸Šçš„ç±»åº“</li></ul></li><li><strong>è‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼ˆUser ClassLoaderï¼‰ï¼š</strong><ul><li>ä½œç”¨ï¼šJVMè‡ªå¸¦çš„ä¸‰ä¸ªåŠ è½½å™¨åªèƒ½åŠ è½½æŒ‡å®šè·¯å¾„ä¸‹çš„ç±»å­—èŠ‚ç ï¼Œ<strong>å¦‚æœæŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦åŠ è½½åº”ç”¨ç¨‹åºä¹‹å¤–çš„ç±»æ–‡ä»¶å‘¢ï¼Ÿå°±éœ€è¦ç”¨åˆ°è‡ªå®šä¹‰ç±»åŠ è½½å™¨</strong>ï¼Œå°±åƒæ˜¯åœ¨æ±½è½¦è¡Œé©¶çš„æ—¶å€™ï¼Œä¸ºæ±½è½¦æ›´æ¢è½®å­ã€‚</li><li>æ¯”å¦‚æœ¬åœ°Dç›˜ä¸‹çš„ï¼Œæˆ–è€…å»åŠ è½½ç½‘ç»œä¸Šçš„æŸä¸ªç±»æ–‡ä»¶ï¼Œè¿™ç§æƒ…å†µå°±å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰åŠ è½½å™¨äº†ã€‚</li><li>ä¸¾ä¸ªæ —å­ï¼šJRebel</li></ul></li></ul><figure><img src="/lzc-blog.github.io/assets/sudu9l6d-a-TrIs6ASE.png" alt="image-20220808155957333" tabindex="0" loading="lazy"><figcaption>image-20220808155957333</figcaption></figure><h4 id="è‡ªå®šä¹‰ç±»åŠ è½½å™¨æ¡ˆä¾‹" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰ç±»åŠ è½½å™¨æ¡ˆä¾‹" aria-hidden="true">#</a> è‡ªå®šä¹‰ç±»åŠ è½½å™¨æ¡ˆä¾‹ï¼š</h4><p>ç›®æ ‡ï¼šè‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼ŒåŠ è½½æŒ‡å®šè·¯å¾„åœ¨Dç›˜ä¸‹çš„libæ–‡ä»¶å¤¹ä¸‹çš„ç±»ã€‚</p><p><strong>æ­¥éª¤ï¼š</strong></p><ol><li>æ–°å»ºä¸€ä¸ªéœ€è¦è¢«åŠ è½½çš„ç±»Test.jave</li><li>ç¼–è¯‘Test.javeåˆ°æŒ‡å®šlibç›®å½•</li><li>è‡ªå®šä¹‰ç±»åŠ è½½å™¨HeroClassLoaderç»§æ‰¿ClassLoaderï¼š <ul><li>é‡å†™findClass()æ–¹æ³•</li><li>è°ƒç”¨defineClass()æ–¹æ³•</li></ul></li><li>æµ‹è¯•è‡ªå®šä¹‰ç±»åŠ è½½å™¨</li></ol><h4 id="_1-2-4-åŒäº²å§”æ´¾æ¨¡å‹ä¸æ‰“ç ´åŒäº²å§”æ´¾" tabindex="-1"><a class="header-anchor" href="#_1-2-4-åŒäº²å§”æ´¾æ¨¡å‹ä¸æ‰“ç ´åŒäº²å§”æ´¾" aria-hidden="true">#</a> 1.2.4 åŒäº²å§”æ´¾æ¨¡å‹ä¸æ‰“ç ´åŒäº²å§”æ´¾</h4><h4 id="_1-ä»€ä¹ˆæ˜¯åŒäº²å§”æ´¾" tabindex="-1"><a class="header-anchor" href="#_1-ä»€ä¹ˆæ˜¯åŒäº²å§”æ´¾" aria-hidden="true">#</a> 1ï¼‰ä»€ä¹ˆæ˜¯åŒäº²å§”æ´¾ï¼Ÿ</h4><ul><li><strong>å½“ä¸€ä¸ªç±»åŠ è½½å™¨æ”¶åˆ°ç±»åŠ è½½ä»»åŠ¡ï¼Œä¼šå…ˆäº¤ç»™å…¶çˆ¶ç±»åŠ è½½å™¨å»å®Œæˆ</strong>ã€‚å› æ­¤ï¼Œæœ€ç»ˆåŠ è½½ä»»åŠ¡éƒ½ä¼šä¼ é€’åˆ°é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨ï¼Œ<strong>åªæœ‰å½“çˆ¶ç±»åŠ è½½å™¨æ— æ³•å®ŒæˆåŠ è½½ä»»åŠ¡æ—¶ï¼Œå­ç±»æ‰ä¼šå°è¯•æ‰§è¡ŒåŠ è½½ä»»åŠ¡</strong>ã€‚</li></ul><blockquote><p>Oracle å®˜ç½‘æ–‡æ¡£æè¿°ï¼š <strong>The Java Class Loading Mechanism</strong> The Java platform uses a delegation model for loading classes. The basic idea is that every class loader has a &quot;parent&quot; class loader. When loading a class, a class loader first &quot;delegates&quot; the search for the class to its parent class loader before attempting to find the class itself.â€”â€” Oracel Document <a href="https://docs.oracle.com/javase/tutorial/ext/basics/load.html" target="_blank" rel="noopener noreferrer">https://docs.oracle.com/javase/tutorial/ext/basics/load.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> çœ‹åˆ°è¿™é‡Œï¼Œåº”è¯¥å«çˆ¶äº²å§”æ´¾å¯¹å§ï¼Ÿé‚£ä¹ˆä¸ºä»€ä¹ˆè¦å«åŒäº²å§”æ´¾å‘¢ï¼Œå› ä¸ºæœ€æ—©çš„ç¿»è¯‘è€…ï¼Œå¯¼è‡´åŒäº²å§”æ´¾çš„æ¦‚å¿µæµè¡Œèµ·æ¥äº†ã€‚</p></blockquote><h4 id="_2-ä¸ºä»€ä¹ˆéœ€è¦åŒäº²å§”æ´¾å‘¢" tabindex="-1"><a class="header-anchor" href="#_2-ä¸ºä»€ä¹ˆéœ€è¦åŒäº²å§”æ´¾å‘¢" aria-hidden="true">#</a> 2ï¼‰ä¸ºä»€ä¹ˆéœ€è¦åŒäº²å§”æ´¾å‘¢ï¼Ÿ</h4><ul><li><!----></li><li>æ¯”å¦‚ï¼šåŠ è½½ä½äºrt.jaråŒ…ä¸­çš„ç±»java.lang.Objectï¼Œä¸ç®¡æ˜¯å“ªä¸ªåŠ è½½å™¨åŠ è½½è¿™ä¸ªç±»ï¼Œæœ€ç»ˆéƒ½æ˜¯å§”æ‰˜ç»™é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨è¿›è¡ŒåŠ è½½ï¼Œè¿™æ ·å°±ä¿è¯äº†ä½¿ç”¨ä¸åŒçš„ç±»åŠ è½½å™¨æœ€ç»ˆå¾—åˆ°çš„éƒ½æ˜¯åŒæ ·ä¸€ä¸ªObjectå¯¹è±¡ã€‚</li></ul><h4 id="_3-åŒäº²å§”æ´¾æœºåˆ¶æºç " tabindex="-1"><a class="header-anchor" href="#_3-åŒäº²å§”æ´¾æœºåˆ¶æºç " aria-hidden="true">#</a> 3ï¼‰åŒäº²å§”æ´¾æœºåˆ¶æºç ï¼š</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">loadClass</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">boolean</span> resolve<span class="token punctuation">)</span>
        <span class="token keyword">throws</span> <span class="token class-name">ClassNotFoundException</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token function">getClassLoadingLock</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// é¦–å…ˆ, æ£€æŸ¥classæ˜¯å¦è¢«åŠ è½½ï¼Œå¦‚æœæ²¡æœ‰åŠ è½½åˆ™è¿›è¡ŒåŠ è½½</span>
            <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> c <span class="token operator">=</span> <span class="token function">findLoadedClass</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">long</span> t0 <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>parent <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//å¦‚æœçˆ¶ç±»åŠ è½½ä¸ä¸ºç©ºï¼Œåˆ™äº¤ç»™çˆ¶ç±»åŠ è½½å™¨åŠ è½½</span>
                        c <span class="token operator">=</span> parent<span class="token punctuation">.</span><span class="token function">loadClass</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                        c <span class="token operator">=</span> <span class="token function">findBootstrapClassOrNull</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">// ClassNotFoundException thrown if class not found</span>
                    <span class="token comment">// from the non-null parent class loader</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//çˆ¶ç±»åŠ è½½å™¨æ²¡æœ‰åŠ è½½åˆ°ï¼Œåˆ™ç”±å­ç±»è¿›è¡ŒåŠ è½½</span>
                    <span class="token comment">// If still not found, then invoke findClass in order</span>
                    <span class="token comment">// to find the class.</span>
                    <span class="token keyword">long</span> t1 <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">nanoTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    c <span class="token operator">=</span> <span class="token function">findClass</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// this is the defining class loader; record the stats</span>
                    <span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>PerfCounter</span><span class="token punctuation">.</span><span class="token function">getParentDelegationTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTime</span><span class="token punctuation">(</span>t1 <span class="token operator">-</span> t0<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>PerfCounter</span><span class="token punctuation">.</span><span class="token function">getFindClassTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addElapsedTimeFrom</span><span class="token punctuation">(</span>t1<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>PerfCounter</span><span class="token punctuation">.</span><span class="token function">getFindClasses</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>resolve<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">resolveClass</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> c<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>


</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-ä¸ºä»€ä¹ˆè¿˜éœ€è¦ç ´ååŒäº²å§”æ´¾" tabindex="-1"><a class="header-anchor" href="#_4-ä¸ºä»€ä¹ˆè¿˜éœ€è¦ç ´ååŒäº²å§”æ´¾" aria-hidden="true">#</a> 4ï¼‰ä¸ºä»€ä¹ˆè¿˜éœ€è¦ç ´ååŒäº²å§”æ´¾ï¼Ÿ</h4><ul><li><!----></li><li>ä¸¾ä¸ªæ —å­ï¼šæ•°æ®åº“é©±åŠ¨DriverManagerã€‚ä»¥Driveræ¥å£ä¸ºä¾‹ï¼ŒDriveræ¥å£å®šä¹‰åœ¨JDKä¸­ï¼Œå…¶<strong>å®ç°ç”±å„ä¸ªæ•°æ®åº“çš„æœåŠ¡å•†æ¥æä¾›ï¼Œç”±ç³»ç»Ÿç±»åŠ è½½å™¨åŠ è½½</strong>ã€‚è¿™ä¸ªæ—¶å€™å°±éœ€è¦<strong>å¯åŠ¨ç±»åŠ è½½å™¨</strong>æ¥ **å§”æ‰˜ **å­ç±»æ¥åŠ è½½Driverå®ç°ï¼Œè¿™å°±ç ´åäº†åŒäº²å§”æ´¾ã€‚ç±»ä¼¼æƒ…å†µè¿˜æœ‰å¾ˆå¤š</li></ul><h4 id="_5-å¦‚ä½•ç ´ååŒäº²å§”æ´¾" tabindex="-1"><a class="header-anchor" href="#_5-å¦‚ä½•ç ´ååŒäº²å§”æ´¾" aria-hidden="true">#</a> 5ï¼‰å¦‚ä½•ç ´ååŒäº²å§”æ´¾ï¼Ÿ</h4><h4 id="ç¬¬ä¸€ç§æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#ç¬¬ä¸€ç§æ–¹å¼" aria-hidden="true">#</a> ç¬¬ä¸€ç§æ–¹å¼</h4><ul><li>åœ¨ jdk 1.2 ä¹‹å‰ï¼Œé‚£æ—¶å€™è¿˜æ²¡æœ‰åŒäº²å§”æ´¾æ¨¡å‹ï¼Œä¸è¿‡å·²ç»æœ‰äº† ClassLoader è¿™ä¸ªæŠ½è±¡ç±»ï¼Œæ‰€ä»¥å·²ç»æœ‰äººç»§æ‰¿è¿™ä¸ªæŠ½è±¡ç±»ï¼Œ<strong>é‡å†™ loadClass</strong> æ–¹æ³•æ¥<strong>å®ç°ç”¨æˆ·è‡ªå®šä¹‰ç±»åŠ è½½å™¨</strong>ã€‚</li><li>è€Œåœ¨ 1.2 çš„æ—¶å€™è¦<strong>å¼•å…¥åŒäº²å§”æ´¾æ¨¡å‹</strong>ï¼Œä¸ºäº†å‘å‰å…¼å®¹ï¼Œ loadClass è¿™ä¸ªæ–¹æ³•è¿˜å¾—ä¿ç•™ç€ä½¿ä¹‹å¾—ä»¥é‡å†™ï¼Œæ–°æäº†ä¸ª findClass æ–¹æ³•è®©ç”¨æˆ·å»é‡å†™ï¼Œå¹¶å‘¼åå¤§å®¶ä¸è¦é‡å†™ loadClass åªè¦é‡å†™ findClassã€‚</li><li>è¿™å°±æ˜¯ç¬¬ä¸€æ¬¡å¯¹åŒäº²å§”æ´¾æ¨¡å‹çš„ç ´åï¼Œ<strong>å› ä¸ºåŒäº²å§”æ´¾çš„é€»è¾‘åœ¨ loadClass ä¸Šï¼Œä½†æ˜¯åˆå…è®¸é‡å†™ loadClassï¼Œé‡å†™äº†ä¹‹åå°±å¯ä»¥ç ´åå§”æ´¾é€»è¾‘äº†ã€‚</strong></li></ul><h4 id="ç¬¬äºŒç§æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#ç¬¬äºŒç§æ–¹å¼" aria-hidden="true">#</a> ç¬¬äºŒç§æ–¹å¼ï¼š</h4><ul><li>åŒäº²å§”æ´¾æœºåˆ¶æ˜¯ä¸€ç§<strong>è‡ªä¸Šè€Œä¸‹çš„åŠ è½½éœ€æ±‚ï¼Œè¶Šå¾€ä¸Šç±»è¶ŠåŸºç¡€</strong>ã€‚</li><li>SPIä»£ç æ‰“ç ´äº†åŒäº²å§”æ´¾</li></ul><p>DriverManageræºç </p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">static</span> <span class="token punctuation">{</span>
    <span class="token function">loadInitialDrivers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;JDBC DriverManager initialized&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>  
  
<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">loadInitialDrivers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> drivers<span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        drivers <span class="token operator">=</span> <span class="token class-name">AccessController</span><span class="token punctuation">.</span><span class="token function">doPrivileged</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PrivilegedAction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;jdbc.drivers&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        drivers <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">AccessController</span><span class="token punctuation">.</span><span class="token function">doPrivileged</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PrivilegedAction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token class-name">Void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token class-name">ServiceLoader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Driver</span><span class="token punctuation">&gt;</span></span> loadedDrivers <span class="token operator">=</span> <span class="token class-name">ServiceLoader</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token class-name">Driver</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Driver</span><span class="token punctuation">&gt;</span></span> driversIterator <span class="token operator">=</span> loadedDrivers<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
            <span class="token keyword">try</span><span class="token punctuation">{</span>
                <span class="token keyword">while</span><span class="token punctuation">(</span>driversIterator<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    driversIterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">Throwable</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// Do nothing</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;DriverManager.initialize: jdbc.drivers = &quot;</span> <span class="token operator">+</span> drivers<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>drivers <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> drivers<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> driversList <span class="token operator">=</span> drivers<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;number of Drivers:&quot;</span> <span class="token operator">+</span> driversList<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> aDriver <span class="token operator">:</span> driversList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;DriverManager.Initialize: loading &quot;</span> <span class="token operator">+</span> aDriver<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//åœ¨è¿™é‡Œéœ€è¦åŠ è½½å„ä¸ªå‚å•†å®ç°çš„æ•°æ®åº“é©±åŠ¨com.mysql.jdbc.Driver</span>
            <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>aDriver<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token class-name">ClassLoader</span><span class="token punctuation">.</span><span class="token function">getSystemClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;DriverManager.Initialize: load failed: &quot;</span> <span class="token operator">+</span> ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å¦‚æœå‡ºç°SPIç›¸å…³ä»£ç æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•è§£å†³åŸºç¡€ç±»å»åŠ è½½ç”¨æˆ·ä»£ç ç±»å‘¢ï¼Ÿ</strong></p><p>è¿™ä¸ªæ—¶å€™ï¼ŒJVMä¸å¾—ä¸å¦¥åï¼Œæ¨å‡º<!---->çš„æ¦‚å¿µï¼Œå»è§£å†³è¯¥é—®é¢˜ã€‚è¿™æ ·ä¹Ÿå°±æ‰“ç ´äº†åŒäº²å§”æ´¾</p><p><strong>çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨</strong></p><p>ï¼ˆThreadContextClassLoaderï¼‰</p><p><strong>è®¾ç½®çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨æºç </strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">Launcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Create the extension class loader</span>
    <span class="token class-name">ClassLoader</span> extcl<span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ‰©å±•ç±»åŠ è½½å™¨</span>
        extcl <span class="token operator">=</span> <span class="token class-name">ExtClassLoader</span><span class="token punctuation">.</span><span class="token function">getExtClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">InternalError</span><span class="token punctuation">(</span>
            <span class="token string">&quot;Could not create extension class loader&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Now create the class loader to use to launch the application</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">// åº”ç”¨ç±»åŠ è½½å™¨/ç³»ç»Ÿç±»åŠ è½½å™¨</span>
        loader <span class="token operator">=</span> <span class="token class-name">AppClassLoader</span><span class="token punctuation">.</span><span class="token function">getAppClassLoader</span><span class="token punctuation">(</span>extcl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">InternalError</span><span class="token punctuation">(</span>
            <span class="token string">&quot;Could not create application class loader&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨</span>
    <span class="token comment">// Also set the context class loader for the primordial thread.</span>
    <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setContextClassLoader</span><span class="token punctuation">(</span>loader<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Finally, install a security manager if requested</span>
    <span class="token class-name">String</span> s <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;java.security.manager&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SecurityManager</span> sm <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">&quot;default&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            sm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span>SecurityManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                sm <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">SecurityManager</span><span class="token punctuation">)</span>loader<span class="token punctuation">.</span><span class="token function">loadClass</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IllegalAccessException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InstantiationException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassCastException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>sm <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">setSecurityManager</span><span class="token punctuation">(</span>sm<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">InternalError</span><span class="token punctuation">(</span>
                <span class="token string">&quot;Could not create SecurityManager: &quot;</span> <span class="token operator">+</span> s<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>è·å–çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨æºç </strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">S</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">ServiceLoader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">S</span><span class="token punctuation">&gt;</span></span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">S</span><span class="token punctuation">&gt;</span></span> service<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ClassLoader</span> cl <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContextClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">ServiceLoader</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>service<span class="token punctuation">,</span> cl<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/lzc-blog.github.io/assets/xzefkxhulu-jBEH25ij.jpg" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="ç¬¬ä¸‰ç§æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#ç¬¬ä¸‰ç§æ–¹å¼" aria-hidden="true">#</a> ç¬¬ä¸‰ç§æ–¹å¼</h4><p>ä¸ºäº†æ»¡è¶³çƒ­éƒ¨ç½²ã€ä¸åœæœºæ›´æ–°éœ€æ±‚ã€‚OSGI å°±æ˜¯åˆ©ç”¨è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨æœºåˆ¶æ¥å®Œæˆæ¨¡å—åŒ–çƒ­éƒ¨ç½²ï¼Œè€Œå®ƒå®ç°çš„ç±»åŠ è½½æœºåˆ¶å°±æ²¡æœ‰å®Œå…¨éµå¾ªè‡ªä¸‹è€Œä¸Šçš„å§”æ‰˜ï¼Œæœ‰å¾ˆå¤šå¹³çº§ä¹‹é—´çš„ç±»åŠ è½½å™¨æŸ¥æ‰¾ï¼Œå…·ä½“å°±ä¸å±•å¼€äº†ï¼Œæœ‰å…´è¶£å¯ä»¥è‡ªè¡Œç ”ç©¶ä¸€ä¸‹ã€‚</p><h3 id="_1-3-è¿è¡Œæ—¶æ•°æ®åŒº" tabindex="-1"><a class="header-anchor" href="#_1-3-è¿è¡Œæ—¶æ•°æ®åŒº" aria-hidden="true">#</a> 1.3 è¿è¡Œæ—¶æ•°æ®åŒº</h3><p>æ•´ä¸ªJVMæ„æˆé‡Œé¢ï¼Œç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼šç±»åŠ è½½ç³»ç»Ÿã€<strong>è¿è¡Œæ—¶æ•°æ®åŒº</strong>ã€æ‰§è¡Œå¼•æ“</p><figure><img src="/lzc-blog.github.io/assets/9ahq_2j34--zDNUq-C8.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>æŒ‰ç…§çº¿ç¨‹ä½¿ç”¨æƒ…å†µå’ŒèŒè´£åˆ†æˆä¸¤å¤§ç±»</p><ul><li>çº¿ç¨‹ç‹¬äº« ï¼ˆç¨‹åºæ‰§è¡ŒåŒºåŸŸï¼‰ <ul><li>ä¸éœ€è¦åƒåœ¾å›æ”¶</li><li>è™šæ‹Ÿæœºæ ˆã€æœ¬åœ°æ–¹æ³•æ ˆã€ç¨‹åºè®¡æ•°å™¨</li></ul></li><li>çº¿ç¨‹å…±äº« ï¼ˆæ•°æ®å­˜å‚¨åŒºåŸŸï¼‰ <ul><li>åƒåœ¾å›æ”¶</li><li>å­˜å‚¨ç±»çš„é™æ€æ•°æ®å’Œå¯¹è±¡æ•°æ®</li><li>å †å’Œæ–¹æ³•åŒº</li></ul></li></ul><h4 id="_1-3-1-å †" tabindex="-1"><a class="header-anchor" href="#_1-3-1-å †" aria-hidden="true">#</a> 1.3.1 å †</h4><p>Javaå †åœ¨JVMå¯åŠ¨æ—¶åˆ›å»ºå†…å­˜åŒºåŸŸå»å®ç°å¯¹è±¡ã€æ•°ç»„ä¸è¿è¡Œæ—¶å¸¸é‡çš„å†…å­˜åˆ†é…ï¼Œå®ƒæ˜¯è™šæ‹Ÿæœºç®¡ç†æœ€å¤§çš„ï¼Œä¹Ÿæ˜¯åƒåœ¾å›æ”¶çš„ä¸»è¦å†…å­˜åŒºåŸŸ ã€‚</p><h4 id="å†…å­˜åˆ’åˆ†" tabindex="-1"><a class="header-anchor" href="#å†…å­˜åˆ’åˆ†" aria-hidden="true">#</a> <strong>å†…å­˜åˆ’åˆ†ï¼š</strong></h4><p><strong>æ ¸å¿ƒé€»è¾‘å°±æ˜¯ä¸‰å¤§å‡è¯´ï¼ŒåŸºäºç¨‹åºè¿è¡Œæƒ…å†µè¿›è¡Œä¸æ–­çš„ä¼˜åŒ–è®¾è®¡ã€‚</strong></p><figure><img src="/lzc-blog.github.io/assets/f-hoerq03l-X1y0tmZr.png" alt="image-20220819094201968" tabindex="0" loading="lazy"><figcaption>image-20220819094201968</figcaption></figure><p><strong>å †å†…å­˜ä¸ºä»€ä¹ˆä¼šå­˜åœ¨æ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Ÿ</strong></p><p><strong>åˆ†ä»£æ”¶é›†ç†è®ºï¼šå½“å‰å•†ä¸šè™šæ‹Ÿæœºçš„åƒåœ¾æ”¶é›†å™¨ï¼Œå¤§å¤šæ•°éƒ½éµå¾ªäº†â€œåˆ†ä»£æ”¶é›†â€ï¼ˆGenerational Collectionï¼‰çš„ç†è®ºè¿›è¡Œè®¾è®¡ï¼Œåˆ†ä»£æ”¶é›†åä¸ºç†è®ºï¼Œå®è´¨æ˜¯ä¸€å¥—ç¬¦åˆå¤§å¤šæ•°ç¨‹åºè¿è¡Œå®é™…æƒ…å†µçš„ç»éªŒæ³•åˆ™</strong>ï¼Œå®ƒå»ºç«‹åœ¨ä¸¤ä¸ªåˆ†ä»£å‡è¯´ä¹‹ä¸Šï¼š</p><ul><li>å¼±åˆ†ä»£å‡è¯´ï¼ˆWeak Generational Hypothesisï¼‰ï¼šç»å¤§å¤šæ•°å¯¹è±¡éƒ½æ˜¯æœç”Ÿå¤•ç­çš„ã€‚</li><li>å¼ºåˆ†ä»£å‡è¯´ï¼ˆStrong Generational Hypothesisï¼‰ï¼šç†¬è¿‡è¶Šå¤šæ¬¡åƒåœ¾æ”¶é›†è¿‡ç¨‹çš„å¯¹è±¡å°±è¶Šéš¾ä»¥æ¶ˆäº¡ã€‚</li></ul><p>è¿™ä¸¤ä¸ªåˆ†ä»£å‡è¯´å…±åŒå¥ å®šäº†å¤šæ¬¾å¸¸ç”¨çš„åƒåœ¾æ”¶é›†å™¨çš„ä¸€è‡´çš„è®¾è®¡åŸåˆ™ï¼šæ”¶é›†å™¨åº”è¯¥å°†Javaå †åˆ’åˆ†å‡ºä¸åŒçš„åŒºåŸŸï¼Œç„¶åå°†å›æ”¶å¯¹è±¡ä¾æ®å…¶å¹´é¾„ï¼ˆå¹´é¾„å³å¯¹è±¡ç†¬è¿‡åƒåœ¾æ”¶é›†è¿‡ç¨‹çš„æ¬¡æ•°ï¼‰åˆ†é…åˆ°ä¸åŒçš„åŒºåŸŸä¹‹ä¸­å­˜å‚¨ã€‚</p><ul><li>å¦‚æœä¸€ä¸ªåŒºåŸŸä¸­å¤§å¤šæ•°å¯¹è±¡éƒ½æ˜¯æœç”Ÿå¤•ç­ï¼Œéš¾ä»¥ç†¬è¿‡åƒåœ¾æ”¶é›†è¿‡ç¨‹çš„è¯ï¼Œé‚£ä¹ˆæŠŠå®ƒä»¬é›†ä¸­æ”¾åœ¨ä¸€èµ·ï¼Œæ¯æ¬¡å›æ”¶æ—¶åªå…³æ³¨å¦‚ä½•ä¿ç•™å°‘é‡å­˜æ´»è€Œä¸æ˜¯å»æ ‡è®°é‚£äº›å¤§é‡å°†è¦è¢«å›æ”¶çš„å¯¹è±¡ï¼Œå°±èƒ½<strong>ä»¥è¾ƒä½ä»£ä»·å›æ”¶åˆ°å¤§é‡çš„ç©ºé—´ï¼›</strong></li><li>å¦‚æœå‰©ä¸‹çš„éƒ½æ˜¯éš¾ä»¥æ¶ˆäº¡çš„å¯¹è±¡ï¼Œé‚£æŠŠå®ƒä»¬é›†ä¸­æ”¾åœ¨ä¸€å—ï¼Œè™šæ‹Ÿæœºä¾¿å¯ä»¥ä½¿ç”¨<strong>è¾ƒä½çš„é¢‘ç‡æ¥å›æ”¶è¿™ä¸ªåŒºåŸŸã€‚</strong></li></ul><p>è¿™å°±åŒæ—¶<strong>å…¼é¡¾äº†åƒåœ¾æ”¶é›†çš„æ—¶é—´å¼€é”€å’Œå†…å­˜çš„ç©ºé—´æœ‰æ•ˆåˆ©ç”¨</strong>ã€‚</p><p><strong>ä¸ºä»€ä¹ˆæ–°ç”Ÿä»£é‡Œé¢éœ€è¦æœ‰ä¸¤ä¸ªSurvivoråŒºåŸŸå‘¢ï¼Ÿ</strong></p><ul><li>è¿™ä¸ªå’±ä»¬åœ¨åƒåœ¾æ”¶é›†å™¨å°èŠ‚è¿›è¡Œè§£é‡Š</li></ul><h4 id="å†…å­˜æ¨¡å‹å˜è¿" tabindex="-1"><a class="header-anchor" href="#å†…å­˜æ¨¡å‹å˜è¿" aria-hidden="true">#</a> <strong>å†…å­˜æ¨¡å‹å˜è¿ï¼š</strong></h4><ul><li><p>JDK1.7ï¼š</p><figure><img src="/lzc-blog.github.io/assets/7hk66mytm4-H37LE6b1.jpg" alt="æœªæ ‡é¢˜-10-13" tabindex="0" loading="lazy"><figcaption>æœªæ ‡é¢˜-10-13</figcaption></figure><ul><li>Young å¹´è½»åŒº ï¼šä¸»è¦ä¿å­˜å¹´è½»å¯¹è±¡ï¼Œåˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼ŒEdenåŒºã€ä¸¤ä¸ªSurvivoråŒºã€‚</li><li>Tenured å¹´è€åŒº ï¼šä¸»è¦ä¿å­˜å¹´é•¿å¯¹è±¡ï¼Œå½“å¯¹è±¡åœ¨Youngå¤åˆ¶è½¬ç§»ä¸€å®šçš„æ¬¡æ•°åï¼Œå¯¹è±¡å°±ä¼šè¢«è½¬ç§»åˆ°TenuredåŒºã€‚</li><li>Perm æ°¸ä¹…åŒº ï¼šä¸»è¦ä¿å­˜classã€methodã€filedå¯¹è±¡ï¼Œè¿™éƒ¨ä»½çš„ç©ºé—´ä¸€èˆ¬ä¸ä¼šæº¢å‡ºï¼Œé™¤éä¸€æ¬¡æ€§åŠ è½½äº†å¾ˆå¤šçš„ç±»ï¼Œä¸è¿‡åœ¨æ¶‰åŠåˆ°çƒ­éƒ¨ç½²çš„åº”ç”¨æœåŠ¡å™¨çš„æ—¶å€™ï¼Œæœ‰æ—¶å€™ä¼šé‡åˆ°OOM : PermGen space çš„é”™è¯¯ã€‚</li><li>VirtualåŒºï¼š æœ€å¤§å†…å­˜å’Œåˆå§‹å†…å­˜çš„å·®å€¼ï¼Œå°±æ˜¯VirtualåŒºã€‚</li></ul></li><li><p>JDK1.8ï¼š</p><figure><img src="/lzc-blog.github.io/assets/0z8hc9-41d-NoyXhSOY.jpg" alt="æœªæ ‡é¢˜-10-14" tabindex="0" loading="lazy"><figcaption>æœªæ ‡é¢˜-10-14</figcaption></figure><ul><li>ç”±2éƒ¨åˆ†ç»„æˆï¼Œæ–°ç”Ÿä»£ï¼ˆEden + 2*Survivor ï¼‰ + å¹´è€ä»£ï¼ˆOldGen ï¼‰</li><li>JDK1.8ä¸­å˜åŒ–æœ€å¤§æ˜¯ï¼Œçš„Permæ°¸ä¹…åŒºç”¨Metaspaceè¿›è¡Œäº†æ›¿æ¢</li><li>æ³¨æ„ï¼šMetaspaceæ‰€å ç”¨çš„å†…å­˜ç©ºé—´ä¸æ˜¯åœ¨è™šæ‹Ÿæœºå†…éƒ¨ï¼Œè€Œæ˜¯åœ¨æœ¬åœ°å†…å­˜ç©ºé—´ä¸­ã€‚åŒºåˆ«äºJDK1.7</li></ul></li><li><p>JDK1.9ï¼š</p><figure><img src="/lzc-blog.github.io/assets/3-syov_lzk-4qlYkQem.jpg" alt="æœªæ ‡é¢˜-10-43" tabindex="0" loading="lazy"><figcaption>æœªæ ‡é¢˜-10-43</figcaption></figure><ul><li>å–æ¶ˆæ–°ç”Ÿä»£ã€è€å¹´ä»£çš„ç‰©ç†åˆ’åˆ†</li><li>å°†å †åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªåŒºåŸŸï¼ˆRegionï¼‰ï¼Œè¿™äº›åŒºåŸŸä¸­åŒ…å«äº†æœ‰é€»è¾‘ä¸Šçš„æ–°ç”Ÿä»£ã€è€å¹´ä»£åŒºåŸŸ</li></ul></li></ul><blockquote><p>å‚¨ç‰©æ”¶çº³</p></blockquote><figure><img src="/lzc-blog.github.io/assets/4ptbryalyq-h5SjvVP3.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="å†…å­˜ä¿¡æ¯æ¡ˆä¾‹" tabindex="-1"><a class="header-anchor" href="#å†…å­˜ä¿¡æ¯æ¡ˆä¾‹" aria-hidden="true">#</a> å†…å­˜ä¿¡æ¯æ¡ˆä¾‹ï¼š</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>hero<span class="token punctuation">.</span>jvm<span class="token punctuation">.</span>memory</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * -Xms100m -Xmx100m
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HeapDemo</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;======start=========&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000000L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;========end=========&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="jdk6å †å†…å­˜ç»“æ„" tabindex="-1"><a class="header-anchor" href="#jdk6å †å†…å­˜ç»“æ„" aria-hidden="true">#</a> JDK6å †å†…å­˜ç»“æ„</h4><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>C:\develop\java\jdk1.6.0_45\bin\javac  HeapDemo.java
C:\develop\java\jdk1.6.0_45\bin\java -Xms100m -Xmx100m HeapDemo
C:\develop\java\jdk1.6.0_45\bin\jmap -heap 3612
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/lzc-blog.github.io/assets/888_vbmngc-AUAxzceD.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="/lzc-blog.github.io/assets/006vyiv9is-oz8z-uXF.png" alt="image-20220819110754664" tabindex="0" loading="lazy"><figcaption>image-20220819110754664</figcaption></figure><h4 id="jdk7å †å†…å­˜ç»“æ„" tabindex="-1"><a class="header-anchor" href="#jdk7å †å†…å­˜ç»“æ„" aria-hidden="true">#</a> JDK7å †å†…å­˜ç»“æ„</h4><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>C:\develop\java\jdk1.7.0_80\bin\javac  HeapDemo.java
C:\develop\java\jdk1.7.0_80\bin\java -Xms100m -Xmx100m HeapDemo
C:\develop\java\jdk1.7.0_80\bin\jmap -heap 10420
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/lzc-blog.github.io/assets/tcdprd-wk3-pi92h87J.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="/lzc-blog.github.io/assets/05drc2answ-o93WRbU0.png" alt="image-20220819110830001" tabindex="0" loading="lazy"><figcaption>image-20220819110830001</figcaption></figure><h4 id="jdk8å †å†…å­˜ç»“æ„" tabindex="-1"><a class="header-anchor" href="#jdk8å †å†…å­˜ç»“æ„" aria-hidden="true">#</a> JDK8å †å†…å­˜ç»“æ„</h4><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>C:\develop\java\jdk1.8.0_251\bin\javac  HeapDemo.java
C:\develop\java\jdk1.8.0_251\bin\java -Xms100m -Xmx100m HeapDemo
C:\develop\java\jdk1.8.0_251\bin\jmap -heap 18276
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/lzc-blog.github.io/assets/qyvafwi9dj-lxP2oyHb.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="/lzc-blog.github.io/assets/t6bvrtzj1s-3Fx5Xp46.png" alt="image-20220819110911083" tabindex="0" loading="lazy"><figcaption>image-20220819110911083</figcaption></figure><h4 id="jdk11å †å†…å­˜ç»“æ„" tabindex="-1"><a class="header-anchor" href="#jdk11å †å†…å­˜ç»“æ„" aria-hidden="true">#</a> JDK11å †å†…å­˜ç»“æ„</h4><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>C:\develop\java\jdk-11.0.7\bin\javac  HeapDemo.java
C:\develop\java\jdk-11.0.7\bin\java -Xms100m -Xmx100m HeapDemo
C:\develop\java\jdk-11.0.7\bin\jhsdb jmap --heap --pid 19380
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/lzc-blog.github.io/assets/jmngr-b1p-bBfD80YE.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="/lzc-blog.github.io/assets/o6kl3c0av8-9PK5nxbH.png" alt="image-20220819111003575" tabindex="0" loading="lazy"><figcaption>image-20220819111003575</figcaption></figure><h4 id="_1-3-2-è™šæ‹Ÿæœºæ ˆ" tabindex="-1"><a class="header-anchor" href="#_1-3-2-è™šæ‹Ÿæœºæ ˆ" aria-hidden="true">#</a> 1.3.2 è™šæ‹Ÿæœºæ ˆ</h4><h4 id="_1-æ ˆå¸§æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#_1-æ ˆå¸§æ˜¯ä»€ä¹ˆ" aria-hidden="true">#</a> 1ï¼‰æ ˆå¸§æ˜¯ä»€ä¹ˆï¼Ÿ</h4><p>æ ˆå¸§(Stack Frame)æ˜¯ç”¨äºæ”¯æŒè™šæ‹Ÿæœºè¿›è¡Œ<strong>æ–¹æ³•æ‰§è¡Œ</strong>çš„æ•°æ®ç»“æ„ã€‚</p><p>æ ˆå¸§å­˜å‚¨äº†æ–¹æ³•çš„<!---->ç­‰ä¿¡æ¯ã€‚æ¯ä¸€ä¸ªæ–¹æ³•ä»è°ƒç”¨è‡³æ‰§è¡Œå®Œæˆçš„è¿‡ç¨‹ï¼Œéƒ½å¯¹åº”ç€ä¸€ä¸ªæ ˆå¸§åœ¨è™šæ‹Ÿæœºæ ˆé‡Œä»å…¥æ ˆåˆ°å‡ºæ ˆçš„è¿‡ç¨‹ã€‚</p><p>æ ˆå†…å­˜ä¸ºçº¿ç¨‹ç§æœ‰çš„ç©ºé—´ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½ä¼šåˆ›å»ºç§æœ‰çš„æ ˆå†…å­˜ï¼Œç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹ç›¸åŒï¼Œæ¯ä¸ªJavaæ–¹æ³•åœ¨æ‰§è¡Œçš„æ—¶å€™éƒ½ä¼šåˆ›å»ºä¸€ä¸ª<!---->ã€‚æ ˆå†…å­˜å¤§å°å†³å®šäº†æ–¹æ³•è°ƒç”¨çš„æ·±åº¦ï¼Œæ ˆå†…å­˜è¿‡å°åˆ™ä¼šå¯¼è‡´æ–¹æ³•è°ƒç”¨çš„æ·±åº¦è¾ƒå°ï¼Œå¦‚é€’å½’è°ƒç”¨çš„æ¬¡æ•°è¾ƒå°‘ã€‚</p><figure><img src="/lzc-blog.github.io/assets/87ss_x514x-ZtWYaJDV.png" alt="image-20220819160028056" tabindex="0" loading="lazy"><figcaption>image-20220819160028056</figcaption></figure><h4 id="_2-å½“å‰æ ˆå¸§" tabindex="-1"><a class="header-anchor" href="#_2-å½“å‰æ ˆå¸§" aria-hidden="true">#</a> 2ï¼‰å½“å‰æ ˆå¸§</h4><p>ä¸€ä¸ªçº¿ç¨‹ä¸­æ–¹æ³•çš„è°ƒç”¨é“¾å¯èƒ½ä¼šå¾ˆé•¿ï¼Œæ‰€ä»¥ä¼šæœ‰å¾ˆå¤šæ ˆå¸§ã€‚åªæœ‰ä½äºJVMè™šæ‹Ÿæœºæ ˆæ ˆé¡¶çš„å…ƒç´ æ‰æ˜¯æœ‰æ•ˆçš„ï¼Œå³ç§°ä¸º<strong>å½“å‰æ ˆå¸§</strong>ï¼Œä¸è¿™ä¸ªæ ˆå¸§ç›¸å…³è¿çš„æ–¹æ³•ç§°ä¸º<strong>å½“å‰æ–¹æ³•</strong>ï¼Œå®šä¹‰è¿™ä¸ªæ–¹æ³•çš„ç±»å«åš<strong>å½“å‰ç±»</strong>ã€‚</p><p>æ‰§è¡Œå¼•æ“è¿è¡Œçš„æ‰€æœ‰<strong>å­—èŠ‚ç æŒ‡ä»¤</strong>éƒ½åªé’ˆå¯¹<strong>å½“å‰æ ˆå¸§</strong>è¿›è¡Œæ“ä½œã€‚å¦‚æœå½“å‰æ–¹æ³•è°ƒç”¨äº†å…¶ä»–æ–¹æ³•ï¼Œæˆ–è€…å½“å‰æ–¹æ³•æ‰§è¡Œç»“æŸï¼Œé‚£è¿™ä¸ªæ–¹æ³•çš„æ ˆå¸§å°±ä¸å†æ˜¯å½“å‰æ ˆå¸§äº†ã€‚</p><h4 id="_3-ä»€ä¹ˆæ—¶å€™åˆ›å»ºæ ˆå¸§" tabindex="-1"><a class="header-anchor" href="#_3-ä»€ä¹ˆæ—¶å€™åˆ›å»ºæ ˆå¸§" aria-hidden="true">#</a> 3ï¼‰ä»€ä¹ˆæ—¶å€™åˆ›å»ºæ ˆå¸§</h4><p>è°ƒç”¨æ–°çš„æ–¹æ³•æ—¶ï¼Œæ–°çš„æ ˆå¸§ä¹Ÿä¼šéšä¹‹åˆ›å»ºã€‚å¹¶ä¸”éšç€ç¨‹åºæ§åˆ¶æƒè½¬ç§»åˆ°æ–°æ–¹æ³•ï¼Œæ–°çš„æ ˆå¸§æˆä¸ºäº†å½“å‰æ ˆå¸§ã€‚æ–¹æ³•è¿”å›ä¹‹é™…ï¼ŒåŸæ ˆå¸§ä¼šè¿”å›æ–¹æ³•çš„æ‰§è¡Œç»“æœç»™ä¹‹å‰çš„æ ˆå¸§(è¿”å›ç»™æ–¹æ³•è°ƒç”¨è€…)ï¼Œéšåè™šæ‹Ÿæœºå°†ä¼šä¸¢å¼ƒæ­¤æ ˆå¸§ã€‚</p><h4 id="_4-æ ˆå¼‚å¸¸çš„ä¸¤ç§æƒ…å†µ" tabindex="-1"><a class="header-anchor" href="#_4-æ ˆå¼‚å¸¸çš„ä¸¤ç§æƒ…å†µ" aria-hidden="true">#</a> 4ï¼‰æ ˆå¼‚å¸¸çš„ä¸¤ç§æƒ…å†µï¼š</h4><ul><li>å¦‚æœçº¿ç¨‹è¯·æ±‚çš„æ ˆæ·±åº¦å¤§äºè™šæ‹Ÿæœºæ‰€å…è®¸çš„æ·±åº¦ï¼ˆXssé»˜è®¤1mï¼‰ï¼Œä¼šæŠ›å‡ºStackOverflowErrorå¼‚å¸¸</li><li>å¦‚æœåœ¨åˆ›å»ºæ–°çš„çº¿ç¨‹æ—¶ï¼Œæ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜å»åˆ›å»ºå¯¹åº”çš„è™šæ‹Ÿæœºæ ˆï¼Œä¼šæŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ã€ä¸ä¸€å®šã€‘</li></ul><h4 id="_5-æ ˆå¼‚å¸¸æ¡ˆä¾‹" tabindex="-1"><a class="header-anchor" href="#_5-æ ˆå¼‚å¸¸æ¡ˆä¾‹" aria-hidden="true">#</a> 5ï¼‰æ ˆå¼‚å¸¸æ¡ˆä¾‹ï¼š</h4><p>å¦‚æœçº¿ç¨‹è¯·æ±‚çš„æ ˆæ·±åº¦å¤§äºè™šæ‹Ÿæœºæ‰€å…è®¸çš„æ·±åº¦ï¼Œå°†ä¼šæŠ›å‡º**<code>StackOverflowError</code>**å¼‚å¸¸ï¼ˆ-Xssï¼‰ï¼›</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>hero<span class="token punctuation">.</span>jvm<span class="token punctuation">.</span>memory</span><span class="token punctuation">;</span>
 
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StackErrorMock</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
 
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        index<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">StackErrorMock</span> mock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StackErrorMock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            mock<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Stack deep : &quot;</span><span class="token operator">+</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>C:\develop\java\jdk1.8.0_251\bin\javac StackErrorMock.java
C:\develop\java\jdk1.8.0_251\bin\java -Xss1m StackErrorMock
C:\develop\java\jdk1.8.0_251\bin\java -Xss256k StackErrorMock
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="/lzc-blog.github.io/assets/ilwqt4xwxb-LitjJcwQ.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><figure><img src="/lzc-blog.github.io/assets/5kol72ou58-YilZ2yus.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>è¡¥å……æ¡ˆä¾‹ï¼šç”¨æ¥æ¼”ç¤ºå¤§é‡åˆ›å»ºçº¿ç¨‹æ’‘çˆ†å†…å­˜ä¼šå‘ç”Ÿä»€ä¹ˆï¼</strong></p><ul><li>æ€è€ƒé¢˜ï¼šå¦‚æœåˆ›å»ºæµ·é‡çº¿ç¨‹çº¿ç¨‹çš„æ—¶å€™ï¼ŒåŒæ—¶æ¯ä¸ªçº¿ç¨‹ç–¯ç‹‚é€’å½’ï¼Œè¯·é—®åˆ°åº•æ˜¯å…ˆOOMè¿˜æ˜¯StackOverflowErrorï¼Ÿ</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestThread</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">100000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token string">&quot;Thread-&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token annotation punctuation">@Override</span>
                <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">try</span> <span class="token punctuation">{</span>
                        <span class="token class-name">String</span> name <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token function">recurive</span><span class="token punctuation">(</span><span class="token number">30000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">SECONDS</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">recurive</span><span class="token punctuation">(</span><span class="token keyword">double</span> d<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>d <span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token function">recurive</span><span class="token punctuation">(</span>d <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_1-3-3-æœ¬åœ°æ–¹æ³•æ ˆ" tabindex="-1"><a class="header-anchor" href="#_1-3-3-æœ¬åœ°æ–¹æ³•æ ˆ" aria-hidden="true">#</a> 1.3.3 æœ¬åœ°æ–¹æ³•æ ˆ</h4><p><strong>æœ¬åœ°æ–¹æ³•æ ˆ</strong>å’Œ<strong>è™šæ‹Ÿæœºæ ˆ</strong>ç›¸ä¼¼ï¼ŒåŒºåˆ«å°±æ˜¯è™šæ‹Ÿæœºæ ˆä¸ºè™šæ‹Ÿæœºæ‰§è¡Œ<strong>JavaæœåŠ¡ï¼ˆå­—èŠ‚ç æœåŠ¡ï¼‰</strong>ï¼Œè€Œæœ¬åœ°æ–¹æ³•æ ˆä¸ºè™šæ‹Ÿæœºä½¿ç”¨åˆ°çš„<strong>Nativeæ–¹æ³•ï¼ˆæ¯”å¦‚C++æ–¹æ³•ï¼‰æœåŠ¡</strong>ã€‚</p><p>ç®€å•åœ°è®²ï¼Œä¸€ä¸ªNative Methodå°±æ˜¯ä¸€ä¸ªJavaè°ƒç”¨éJavaä»£ç çš„æ¥å£ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code> <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">IHaveNatives</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">native</span> <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">Native1</span><span class="token punctuation">(</span> <span class="token keyword">int</span> x <span class="token punctuation">)</span> <span class="token punctuation">;</span>
      <span class="token keyword">native</span> <span class="token keyword">static</span> <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token class-name">Native2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
      <span class="token keyword">native</span> <span class="token keyword">synchronized</span> <span class="token keyword">private</span> <span class="token keyword">float</span> <span class="token class-name">Native3</span><span class="token punctuation">(</span> <span class="token class-name">Object</span> o <span class="token punctuation">)</span> <span class="token punctuation">;</span>
      <span class="token keyword">native</span> <span class="token keyword">void</span> <span class="token class-name">Native4</span><span class="token punctuation">(</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ary <span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä¸ºä»€ä¹ˆéœ€è¦æœ¬åœ°æ–¹æ³•ï¼Ÿ</strong></p><p>Javaæ˜¯ä¸€é—¨é«˜çº§è¯­è¨€ï¼Œæˆ‘ä»¬ä¸ç›´æ¥ä¸æ“ä½œç³»ç»Ÿèµ„æºã€ç³»ç»Ÿç¡¬ä»¶æ‰“äº¤é“ã€‚å¦‚æœæƒ³è¦ç›´æ¥ä¸æ“ä½œç³»ç»Ÿä¸ç¡¬ä»¶æ‰“äº¤é“ï¼Œå°±éœ€è¦ä½¿ç”¨åˆ°æœ¬åœ°æ–¹æ³•äº†ã€‚è¯´ç™½äº†ï¼ŒJavaå¯ä»¥ç›´æ¥é€šè¿‡nativeæ–¹æ³•è°ƒç”¨cppç¼–å†™çš„æ¥å£ï¼å¤šçº¿ç¨‹åº•å±‚å°±æ˜¯è¿™ä¹ˆå®ç°çš„ï¼Œåœ¨å¤šçº¿ç¨‹éƒ¨åˆ†æˆ‘ä»¬ä¼šçœ‹ä¸€ä¸‹Threadå®ç°çš„æºç ï¼Œåˆ°æ—¶å€™å°±å¯ä»¥ç†è§£äº†ã€‚</p><h4 id="_1-3-4-æ–¹æ³•åŒº" tabindex="-1"><a class="header-anchor" href="#_1-3-4-æ–¹æ³•åŒº" aria-hidden="true">#</a> 1.3.4 æ–¹æ³•åŒº</h4><p>æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰æ˜¯å¯ä¾›å„ä¸ªçº¿ç¨‹å…±äº«çš„è¿è¡Œæ—¶å†…å­˜åŒºåŸŸï¼Œæ–¹æ³•åŒºæœ¬è´¨ä¸Šæ˜¯Javaè¯­è¨€<strong>ç¼–è¯‘åä»£ç å­˜å‚¨åŒºåŸŸ</strong>ï¼Œå®ƒå­˜å‚¨æ¯ä¸€ä¸ªç±»çš„ç»“æ„ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š<strong>è¿è¡Œæ—¶å¸¸é‡æ± </strong>ã€æˆå‘˜å˜é‡ã€æ–¹æ³•æ•°æ®ã€æ„é€ æ–¹æ³•å’Œæ™®é€šæ–¹æ³•çš„å­—èŠ‚ç æŒ‡ä»¤ç­‰å†…å®¹ã€‚å¾ˆå¤šè¯­è¨€éƒ½æœ‰ç±»ä¼¼åŒºåŸŸã€‚</p><p>æ–¹æ³•åŒºçš„å…·ä½“å®ç°æœ‰ä¸¤ç§ï¼š<strong>æ°¸ä¹…ä»£ï¼ˆPermGenï¼‰</strong>ã€<strong>å…ƒç©ºé—´ï¼ˆMetaspaceï¼‰</strong></p><h4 id="_1-æ–¹æ³•åŒºå­˜å‚¨ä»€ä¹ˆæ•°æ®" tabindex="-1"><a class="header-anchor" href="#_1-æ–¹æ³•åŒºå­˜å‚¨ä»€ä¹ˆæ•°æ®" aria-hidden="true">#</a> 1ï¼‰æ–¹æ³•åŒºå­˜å‚¨ä»€ä¹ˆæ•°æ®ï¼Ÿ</h4><figure><img src="/lzc-blog.github.io/assets/w2yw_uakzk-3jSnqv9f.png" alt="image-20220819114153815" tabindex="0" loading="lazy"><figcaption>image-20220819114153815</figcaption></figure><p>ä¸»è¦æœ‰å¦‚ä¸‹ä¸‰ç§ç±»å‹</p><ul><li>ç¬¬ä¸€ï¼šClass <ol><li>ç±»å‹ä¿¡æ¯ï¼Œæ¯”å¦‚Classï¼ˆcom.hero.Userç±»ï¼‰</li><li>æ–¹æ³•ä¿¡æ¯ï¼Œæ¯”å¦‚Methodï¼ˆæ–¹æ³•åç§°ã€æ–¹æ³•å‚æ•°åˆ—è¡¨ã€æ–¹æ³•è¿”å›å€¼ä¿¡æ¯ï¼‰</li><li>å­—æ®µä¿¡æ¯ï¼Œæ¯”å¦‚Fieldï¼ˆå­—æ®µç±»å‹ï¼Œå­—æ®µåç§°éœ€è¦ç‰¹æ®Šè®¾ç½®æ‰èƒ½ä¿å­˜çš„ä½ï¼‰</li><li>ç±»å˜é‡ï¼ˆé™æ€å˜é‡ï¼‰ï¼šJDK1.7ä¹‹åï¼Œè½¬ç§»åˆ°å †ä¸­å­˜å‚¨</li><li>æ–¹æ³•è¡¨ï¼ˆæ–¹æ³•è°ƒç”¨çš„æ—¶å€™ï¼‰ åœ¨Aç±»çš„mainæ–¹æ³•ä¸­å»è°ƒç”¨Bç±»çš„method1æ–¹æ³•ï¼Œæ˜¯æ ¹æ®Bç±»çš„æ–¹æ³•è¡¨å»æŸ¥æ‰¾åˆé€‚çš„æ–¹æ³•ï¼Œè¿›è¡Œè°ƒç”¨çš„ã€‚</li></ol></li><li>ç¬¬äºŒï¼šè¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆå­—ç¬¦ä¸²å¸¸é‡æ± ï¼‰ï¼šä»classä¸­çš„å¸¸é‡æ± åŠ è½½è€Œæ¥ï¼ŒJDK1.7ä¹‹åï¼Œè½¬ç§»åˆ°å †ä¸­å­˜å‚¨ <ul><li>å­—é¢é‡ç±»å‹</li><li>å¼•ç”¨ç±»å‹--&gt;å†…å­˜åœ°å€</li></ul></li><li>ç¬¬ä¸‰ï¼šJITç¼–è¯‘å™¨ç¼–è¯‘ä¹‹åçš„ä»£ç ç¼“å­˜</li></ul><p>å¦‚æœéœ€è¦è®¿é—®æ–¹æ³•åŒºä¸­ç±»çš„å…¶ä»–ä¿¡æ¯ï¼Œéƒ½å¿…é¡»å…ˆè·å¾—Classå¯¹è±¡ï¼Œæ‰èƒ½å–è®¿é—®è¯¥Classå¯¹è±¡å…³è”çš„æ–¹æ³•ä¿¡æ¯æˆ–è€…å­—æ®µä¿¡æ¯ã€‚</p><h4 id="_2-æ°¸ä¹…ä»£å’Œå…ƒç©ºé—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#_2-æ°¸ä¹…ä»£å’Œå…ƒç©ºé—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ" aria-hidden="true">#</a> 2ï¼‰æ°¸ä¹…ä»£å’Œå…ƒç©ºé—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h4><ol><li>JDK1.8ä¹‹å‰ä½¿ç”¨çš„æ–¹æ³•åŒºå®ç°æ˜¯<strong>æ°¸ä¹…ä»£</strong>ï¼ŒJDK1.8åŠä»¥åä½¿ç”¨çš„æ–¹æ³•åŒºå®ç°æ˜¯<strong>å…ƒç©ºé—´</strong>ã€‚</li><li><strong>å­˜å‚¨ä½ç½®ä¸åŒï¼š</strong><ul><li><strong>æ°¸ä¹…ä»£</strong>æ‰€ä½¿ç”¨çš„å†…å­˜åŒºåŸŸæ˜¯<strong>JVMè¿›ç¨‹æ‰€ä½¿ç”¨çš„åŒºåŸŸ</strong>ï¼Œå®ƒçš„å¤§å°å—æ•´ä¸ªJVMçš„å¤§å°æ‰€é™åˆ¶ã€‚</li><li><strong>å…ƒç©ºé—´</strong>æ‰€ä½¿ç”¨çš„å†…å­˜åŒºåŸŸæ˜¯ç‰©ç†å†…å­˜åŒºåŸŸã€‚é‚£ä¹ˆå…ƒç©ºé—´çš„ä½¿ç”¨å¤§å°åªä¼šå—ç‰©ç†å†…å­˜å¤§å°çš„é™åˆ¶ã€‚</li></ul></li><li><strong>å­˜å‚¨å†…å®¹ä¸åŒï¼š</strong><ul><li>æ°¸ä¹…ä»£å­˜å‚¨çš„ä¿¡æ¯åŸºæœ¬ä¸Šå°±æ˜¯ä¸Šé¢æ–¹æ³•åŒºå­˜å‚¨å†…å®¹ä¸­çš„æ•°æ®ã€‚</li><li>å…ƒç©ºé—´åªå­˜å‚¨ç±»çš„å…ƒä¿¡æ¯ï¼Œè€Œ<strong>é™æ€å˜é‡å’Œè¿è¡Œæ—¶å¸¸é‡æ± éƒ½æŒªåˆ°å †ä¸­</strong>ã€‚</li></ul></li></ol><h4 id="_3-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å…ƒç©ºé—´æ¥æ›¿æ¢æ°¸ä¹…ä»£" tabindex="-1"><a class="header-anchor" href="#_3-ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å…ƒç©ºé—´æ¥æ›¿æ¢æ°¸ä¹…ä»£" aria-hidden="true">#</a> 3ï¼‰ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å…ƒç©ºé—´æ¥æ›¿æ¢æ°¸ä¹…ä»£ï¼Ÿ</h4><ol><li><strong>å­—ç¬¦ä¸²å­˜åœ¨æ°¸ä¹…ä»£ä¸­ï¼Œå®¹æ˜“å‡ºç°æ€§èƒ½é—®é¢˜å’Œæ°¸ä¹…ä»£å†…å­˜æº¢å‡ºã€‚</strong></li><li>ç±»åŠæ–¹æ³•çš„ä¿¡æ¯ç­‰æ¯”è¾ƒéš¾ç¡®å®šå…¶å¤§å°ï¼Œå› æ­¤å¯¹äºæ°¸ä¹…ä»£çš„å¤§å°æŒ‡å®šæ¯”è¾ƒå›°éš¾ï¼Œå¤ªå°å®¹æ˜“å‡ºç°æ°¸ä¹…ä»£æº¢å‡ºï¼Œå¤ªå¤§åˆ™å®¹æ˜“å¯¼è‡´è€å¹´ä»£æº¢å‡ºã€‚</li><li>æ°¸ä¹…ä»£ä¼šä¸º GC å¸¦æ¥ä¸å¿…è¦çš„å¤æ‚åº¦ï¼Œå¹¶ä¸”å›æ”¶æ•ˆç‡åä½ã€‚</li><li>Oracle è®¡åˆ’å°†HotSpot ä¸ JRockit åˆäºŒä¸ºä¸€ã€‚</li></ol><p><strong>æ–¹æ³•åŒºå®ç°å˜è¿å†å²ï¼š</strong></p><figure><img src="/lzc-blog.github.io/assets/nr0v6xfvfx-giCDFo11.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><blockquote><p>ç§»é™¤æ°¸ä¹…ä»£çš„å·¥ä½œä»JDK1.7å°±å¼€å§‹äº†ã€‚JDK1.7ä¸­ï¼Œå­˜å‚¨åœ¨æ°¸ä¹…ä»£çš„éƒ¨åˆ†æ•°æ®å°±å·²ç»è½¬ç§»åˆ°äº†Java Heapã€‚ä½†æ°¸ä¹…ä»£ä»å­˜åœ¨äºJDK1.7ä¸­ï¼Œå¹¶æ²¡å®Œå…¨ç§»é™¤ï¼Œè­¬å¦‚ï¼šå­—é¢é‡è½¬ç§»åˆ°äº†java heapï¼›ç±»çš„é™æ€å˜é‡(class statics)è½¬ç§»åˆ°äº†java heapã€‚</p></blockquote><h4 id="_4-å­—ç¬¦ä¸²oomå¼‚å¸¸æ¡ˆä¾‹" tabindex="-1"><a class="header-anchor" href="#_4-å­—ç¬¦ä¸²oomå¼‚å¸¸æ¡ˆä¾‹" aria-hidden="true">#</a> 4ï¼‰å­—ç¬¦ä¸²OOMå¼‚å¸¸æ¡ˆä¾‹</h4><h4 id="æ¡ˆä¾‹ä»£ç " tabindex="-1"><a class="header-anchor" href="#æ¡ˆä¾‹ä»£ç " aria-hidden="true">#</a> æ¡ˆä¾‹ä»£ç </h4><p>ä»¥ä¸‹è¿™æ®µç¨‹åºä»¥2çš„æŒ‡æ•°çº§ä¸æ–­çš„ç”Ÿæˆæ–°çš„å­—ç¬¦ä¸²ï¼Œè¿™æ ·å¯ä»¥æ¯”è¾ƒå¿«é€Ÿçš„æ¶ˆè€—å†…å­˜ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>hero<span class="token punctuation">.</span>jvm<span class="token punctuation">.</span>memory</span><span class="token punctuation">;</span> 
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span> 

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StringOomMock</span> <span class="token punctuation">{</span>  
    <span class="token keyword">static</span> <span class="token class-name">String</span>  base <span class="token operator">=</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">;</span>  
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token constant">MAX_VALUE</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  
            <span class="token class-name">String</span> str <span class="token operator">=</span> base <span class="token operator">+</span> base<span class="token punctuation">;</span>  
            base <span class="token operator">=</span> str<span class="token punctuation">;</span>  
            list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token punctuation">}</span>  
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="jdk1-6" tabindex="-1"><a class="header-anchor" href="#jdk1-6" aria-hidden="true">#</a> JDK1.6</h4><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>C:\develop\java\jdk1.6.0_45\bin\javac  StringOomMock.java
C:\develop\java\jdk1.6.0_45\bin\java -XX:PermSize=8m -XX:MaxPermSize=8m -Xmx16m StringOomMock
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>JDK 1.6 çš„è¿è¡Œç»“æœï¼š</p><figure><img src="/lzc-blog.github.io/assets/n-q75d8_w7-bAtqu9wa.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>åœ¨JDK 1.6ä¸‹ï¼Œä¼šå‡ºç°æ°¸ä¹…ä»£çš„å†…å­˜æº¢å‡ºã€‚</p></li></ul><h4 id="jdk1-7" tabindex="-1"><a class="header-anchor" href="#jdk1-7" aria-hidden="true">#</a> JDK1.7</h4><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>C:\develop\java\jdk1.7.0_80\bin\javac  StringOomMock.java
C:\develop\java\jdk1.7.0_80\bin\java -XX:PermSize=8m -XX:MaxPermSize=8m -Xmx16m StringOomMock
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>JDK 1.7çš„è¿è¡Œç»“æœï¼š</p><figure><img src="/lzc-blog.github.io/assets/sy0o6tciwy-GtZOpeRC.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>åœ¨JDK 1.7ä¸­ï¼Œä¼šå‡ºç°<strong>å †å†…å­˜æº¢å‡º</strong>ã€‚</p></li><li><p>ç»“è®ºæ˜¯ï¼š<strong>JDK 1.7 å·²ç»å°†å­—ç¬¦ä¸²å¸¸é‡ç”±æ°¸ä¹…ä»£è½¬ç§»åˆ°å †ä¸­ã€‚</strong></p></li></ul><h4 id="jdk1-8" tabindex="-1"><a class="header-anchor" href="#jdk1-8" aria-hidden="true">#</a> JDK1.8+</h4><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>C:\develop\java\jdk1.8.0_251\bin\javac  StringOomMock.java
C:\develop\java\jdk1.8.0_251\bin\java -XX:PermSize=8m -XX:MaxPermSize=8m -Xmx16m StringOomMock
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>JDK 1.8çš„è¿è¡Œç»“æœï¼š</p><figure><img src="/lzc-blog.github.io/assets/bcy8js_ogm-_FZwHsWB.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure></li><li><p>åœ¨JDK 1.8 ä¸­ï¼Œä¹Ÿä¼šå‡ºç°<strong>å †å†…å­˜æº¢å‡º</strong>ï¼Œå¹¶ä¸”æ˜¾ç¤º JDK 1.8ä¸­ <strong>PermSize å’Œ MaxPermGen å·²ç»æ— æ•ˆ</strong>ã€‚</p></li><li><p>ç»“è®ºæ˜¯ï¼š<strong>å¯ä»¥éªŒè¯ JDK 1.8 ä¸­å·²ç»ä¸å­˜åœ¨æ°¸ä¹…ä»£çš„ç»“è®ºã€‚</strong></p></li></ul><h4 id="_1-3-5-å­—ç¬¦ä¸²å¸¸é‡æ± " tabindex="-1"><a class="header-anchor" href="#_1-3-5-å­—ç¬¦ä¸²å¸¸é‡æ± " aria-hidden="true">#</a> 1.3.5 å­—ç¬¦ä¸²å¸¸é‡æ± </h4><h4 id="_1-ä¸‰ç§å¸¸é‡æ± çš„æ¯”è¾ƒ" tabindex="-1"><a class="header-anchor" href="#_1-ä¸‰ç§å¸¸é‡æ± çš„æ¯”è¾ƒ" aria-hidden="true">#</a> 1ï¼‰ä¸‰ç§å¸¸é‡æ± çš„æ¯”è¾ƒ</h4><p><strong>classå¸¸é‡æ± ï¼šä¸€ä¸ªclassæ–‡ä»¶åªæœ‰ä¸€ä¸ªclasså¸¸é‡æ± </strong></p><ul><li>å­—é¢é‡ï¼šæ•°å€¼å‹ï¼ˆintã€floatã€longã€doubleï¼‰ã€åŒå¼•å·å¼•èµ·æ¥çš„å­—ç¬¦ä¸²å€¼ç­‰</li><li>ç¬¦å·å¼•ç”¨ï¼šClassã€Methodã€Fieldç­‰</li></ul><p><strong>è¿è¡Œæ—¶å¸¸é‡æ± ï¼šä¸€ä¸ªclasså¯¹è±¡æœ‰ä¸€ä¸ªè¿è¡Œæ—¶å¸¸é‡æ± </strong></p><ul><li>å­—é¢é‡ï¼šæ•°å€¼å‹ï¼ˆintã€floatã€longã€doubleï¼‰ã€åŒå¼•å·å¼•èµ·æ¥çš„å­—ç¬¦ä¸²å€¼ç­‰</li><li>ç¬¦å·å¼•ç”¨ï¼šClassã€Methodã€Fieldç­‰</li></ul><p><strong>å­—ç¬¦ä¸²å¸¸é‡æ± ï¼šå…¨å±€åªæœ‰ä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡æ± </strong></p><ul><li>åŒå¼•å·å¼•èµ·æ¥çš„å­—ç¬¦ä¸²å€¼</li></ul><figure><img src="/lzc-blog.github.io/assets/e7i82gq__h-Wp75Wt8S.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h4 id="_2-å­—ç¬¦ä¸²å¸¸é‡æ± å¦‚ä½•å­˜å‚¨æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_2-å­—ç¬¦ä¸²å¸¸é‡æ± å¦‚ä½•å­˜å‚¨æ•°æ®" aria-hidden="true">#</a> 2ï¼‰å­—ç¬¦ä¸²å¸¸é‡æ± å¦‚ä½•å­˜å‚¨æ•°æ®ï¼Ÿ</h4><p>ä¸ºäº†æé«˜åŒ¹é…é€Ÿåº¦ï¼Œ å³æ›´å¿«çš„æŸ¥æ‰¾æŸä¸ªå­—ç¬¦ä¸²æ˜¯å¦å­˜åœ¨äºå¸¸é‡æ±  Java åœ¨è®¾è®¡å­—ç¬¦ä¸²å¸¸é‡æ± çš„æ—¶å€™ï¼Œè¿˜æäº†ä¸€å¼ StringTableï¼Œ StringTableé‡Œé¢ä¿å­˜äº†<strong>å­—ç¬¦ä¸²çš„å¼•ç”¨</strong>ã€‚StringTableç±»ä¼¼äºHashTableï¼ˆå“ˆå¸Œè¡¨ï¼‰ã€‚åœ¨JDK1.7+ï¼ŒStringTableå¯ä»¥é€šè¿‡å‚æ•°æŒ‡å®š<code>-XX:StringTableSize=99991</code></p><p><strong>ä»€ä¹ˆæ˜¯å“ˆå¸Œè¡¨å‘¢ï¼Ÿ</strong></p><p>å“ˆå¸Œè¡¨ï¼ˆHash tableï¼Œä¹Ÿå«æ•£åˆ—è¡¨ï¼‰ï¼Œæ˜¯æ ¹æ®å…³é”®ç å€¼(Key value)è€Œç›´æ¥è¿›è¡Œè®¿é—®çš„æ•°æ®ç»“æ„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒé€šè¿‡æŠŠå…³é”®ç å€¼æ˜ å°„åˆ°è¡¨ä¸­ä¸€ä¸ªä½ç½®æ¥è®¿é—®è®°å½•ï¼Œä»¥åŠ å¿«æŸ¥æ‰¾çš„é€Ÿåº¦ã€‚è¿™ä¸ªæ˜ å°„å‡½æ•°å«åšæ•£åˆ—å‡½æ•°ï¼Œå­˜æ”¾è®°å½•çš„æ•°ç»„å«åšæ•£åˆ—è¡¨ã€‚</p><p><strong>å“ˆå¸Œè¡¨æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ•°ç»„+é“¾è¡¨</strong></p><p><strong>ç›®çš„ : ä¸ºäº†åŠ å¿«æ•°æ®æŸ¥æ‰¾çš„é€Ÿåº¦ã€‚</strong></p><p>å­˜åœ¨é—®é¢˜ï¼šhashå†²çªé—®é¢˜ï¼Œä¸€æ—¦å‡ºç°å†²çªï¼Œé‚£ä¹ˆå°±ä¼šå½¢æˆé“¾è¡¨ï¼Œé“¾è¡¨çš„ç‰¹ç‚¹æ˜¯å¢åˆ å¿«ï¼Œä½†æŸ¥è¯¢æ…¢ã€‚</p><blockquote><p>æ•°ç»„ä¸‹æ ‡è®¡ç®—å…¬å¼ï¼šhash(å­—ç¬¦ä¸²) % æ•°ç»„é•¿åº¦ æ•°ç»„ä¸­å­˜å‚¨çš„æ˜¯Entryï¼Œé€šè¿‡æŒ‡é’ˆnextå½¢æˆé“¾è¡¨</p></blockquote><figure><img src="/lzc-blog.github.io/assets/i2fxfdpa1j-yDRoNeVb.png" alt="image-20210606165458143" tabindex="0" loading="lazy"><figcaption>image-20210606165458143</figcaption></figure><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;world&quot;</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;java&quot;</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;world&quot;</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;é€šè¯&quot;</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;é‡åœ°&quot;</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-å­—ç¬¦ä¸²å¸¸é‡æ± å¦‚ä½•æŸ¥æ‰¾å­—ç¬¦ä¸²" tabindex="-1"><a class="header-anchor" href="#_3-å­—ç¬¦ä¸²å¸¸é‡æ± å¦‚ä½•æŸ¥æ‰¾å­—ç¬¦ä¸²" aria-hidden="true">#</a> 3ï¼‰å­—ç¬¦ä¸²å¸¸é‡æ± å¦‚ä½•æŸ¥æ‰¾å­—ç¬¦ä¸²ï¼š</h4><ul><li>æ ¹æ®å­—ç¬¦ä¸²çš„hashcodeæ‰¾åˆ°å¯¹åº”entry</li><li>å¦‚æœæ²¡æœ‰å†²çªï¼Œå®ƒå¯èƒ½åªæ˜¯ä¸€ä¸ªentry</li><li>å¦‚ä½•æœ‰å†²çªï¼Œå®ƒå¯èƒ½æ˜¯ä¸€ä¸ªentryçš„é“¾è¡¨ï¼Œç„¶åJavaå†éå†é“¾è¡¨ï¼ŒåŒ¹é…å¼•ç”¨å¯¹åº”çš„å­—ç¬¦ä¸²</li><li>å¦‚æœæ‰¾åˆ°å­—ç¬¦ä¸²ï¼Œè¿”å›å¼•ç”¨</li><li>å¦‚æœæ‰¾ä¸åˆ°å­—ç¬¦ä¸²ï¼Œåœ¨ä½¿ç”¨intern()æ–¹æ³•çš„æ—¶å€™ï¼Œä¼šå°†intern()æ–¹æ³•è°ƒç”¨è€…çš„å¼•ç”¨æ”¾å…¥åˆ°stringtableä¸­</li></ul><figure><img src="/lzc-blog.github.io/assets/nzz7o_c0ya-QmzpGnoN.png" alt="image-20210606165440854" tabindex="0" loading="lazy"><figcaption>image-20210606165440854</figcaption></figure><h4 id="_4-å­—ç¬¦ä¸²å¸¸é‡æ± æ¡ˆä¾‹" tabindex="-1"><a class="header-anchor" href="#_4-å­—ç¬¦ä¸²å¸¸é‡æ± æ¡ˆä¾‹" aria-hidden="true">#</a> 4ï¼‰å­—ç¬¦ä¸²å¸¸é‡æ± æ¡ˆä¾‹</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StringTableDemo</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;world&quot;</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;java&quot;</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;world&quot;</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;é€šè¯&quot;</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;é‡åœ°&quot;</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//å‡ºç°å“ˆå¸Œå†²çªæ€ä¹ˆåŠï¼Ÿ</span>
        <span class="token comment">//System.out.println(&quot;map = &quot; + map);//</span>
        <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> str1 <span class="token operator">=</span> <span class="token string">&quot;abc&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> str2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">&quot;abc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>str1 <span class="token operator">==</span> str2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//false</span>

        <span class="token class-name">String</span> str3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">&quot;abc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>str3 <span class="token operator">==</span> str2<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//false</span>

        <span class="token class-name">String</span> str4 <span class="token operator">=</span> <span class="token string">&quot;a&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>str4 <span class="token operator">==</span> <span class="token string">&quot;ab&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//true</span>

        <span class="token class-name">String</span> s1 <span class="token operator">=</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> s2 <span class="token operator">=</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> str6 <span class="token operator">=</span> s1 <span class="token operator">+</span> s2<span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>str6 <span class="token operator">==</span> <span class="token string">&quot;ab&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//false</span>

        <span class="token class-name">String</span> str7 <span class="token operator">=</span> <span class="token string">&quot;abc&quot;</span><span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>str7 <span class="token operator">==</span> <span class="token string">&quot;ab&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//false</span>

        <span class="token class-name">String</span> str8 <span class="token operator">=</span> <span class="token string">&quot;abc&quot;</span><span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>str8 <span class="token operator">==</span> <span class="token string">&quot;ABC&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//false</span>

        <span class="token class-name">String</span> s5 <span class="token operator">=</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> s6 <span class="token operator">=</span> <span class="token string">&quot;abc&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> s7 <span class="token operator">=</span> s5 <span class="token operator">+</span> <span class="token string">&quot;bc&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>s6 <span class="token operator">==</span> s7<span class="token punctuation">.</span><span class="token function">intern</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ€»ç»“ï¼š</p><ul><li>å•ç‹¬ä½¿ç”¨â€â€å¼•å·åˆ›å»ºçš„å­—ç¬¦ä¸²éƒ½æ˜¯å¸¸é‡ï¼Œç¼–è¯‘æœŸå°±å·²ç»ç¡®å®šå­˜å‚¨åˆ°String Poolä¸­ã€‚</li><li>ä½¿ç”¨new String(â€œâ€)åˆ›å»ºçš„å¯¹è±¡ä¼šå­˜å‚¨åˆ°heapä¸­ï¼Œæ˜¯è¿è¡ŒæœŸæ–°åˆ›å»ºçš„ã€‚</li><li>ä½¿ç”¨åªåŒ…å«å¸¸é‡çš„å­—ç¬¦ä¸²è¿æ¥ç¬¦å¦‚â€aaâ€+â€bbâ€åˆ›å»ºçš„ä¹Ÿæ˜¯å¸¸é‡ï¼Œç¼–è¯‘æœŸå°±èƒ½ç¡®å®šå·²ç»å­˜å‚¨åˆ°String Poolä¸­ã€‚</li><li>ä½¿ç”¨åŒ…å«å˜é‡çš„å­—ç¬¦ä¸²è¿æ¥å¦‚â€aaâ€+såˆ›å»ºçš„å¯¹è±¡æ˜¯è¿è¡ŒæœŸæ‰åˆ›å»ºçš„ï¼Œå­˜å‚¨åˆ°heapä¸­ã€‚</li><li>è¿è¡ŒæœŸè°ƒç”¨Stringçš„intern()æ–¹æ³•å¯ä»¥å‘String Poolä¸­åŠ¨æ€æ·»åŠ å¯¹è±¡ã€‚</li></ul><h4 id="_1-3-6-ç¨‹åºè®¡æ•°å™¨" tabindex="-1"><a class="header-anchor" href="#_1-3-6-ç¨‹åºè®¡æ•°å™¨" aria-hidden="true">#</a> 1.3.6 ç¨‹åºè®¡æ•°å™¨</h4><!---->ï¼Œæ˜¯ä¸€å—è¾ƒå°çš„å†…å­˜ç©ºé—´ï¼Œå®ƒå¯ä»¥çœ‹ä½œæ˜¯<strong>å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤çš„è¡Œå·æŒ‡ç¤ºå™¨</strong>ã€‚å­—èŠ‚ç è§£é‡Šå™¨çš„å·¥ä½œå°±æ˜¯é€šè¿‡æ”¹å˜è¿™ä¸ªè®¡æ•°å™¨çš„å€¼æ¥é€‰å–ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ã€‚<strong>åˆ†æ”¯ï¼Œå¾ªç¯ï¼Œè·³è½¬ï¼Œå¼‚å¸¸å¤„ç†ï¼Œçº¿ç¨‹å›å¤ç­‰éƒ½éœ€è¦ä¾èµ–è¿™ä¸ªè®¡æ•°å™¨æ¥å®Œæˆã€‚</strong><p><strong>ä¸ºä»€ä¹ˆéœ€è¦ç¨‹åºè®¡æ•°å™¨ï¼Ÿ</strong></p><p>ç”±äºJavaè™šæ‹Ÿæœºçš„å¤šçº¿ç¨‹æ˜¯é€šè¿‡çº¿ç¨‹è½®æµåˆ‡æ¢å¹¶åˆ†é…å¤„ç†å™¨æ‰§è¡Œæ—¶é—´çš„æ–¹å¼æ¥å®ç°çš„ï¼Œåœ¨ä»»ä½•ä¸€ä¸ªç¡®å®šçš„æ—¶åˆ»ï¼Œä¸€ä¸ªå¤„ç†å™¨ï¼ˆé’ˆå¯¹å¤šæ ¸å¤„ç†å™¨æ¥è¯´æ˜¯ä¸€ä¸ªå†…æ ¸ï¼‰éƒ½åªä¼šæ‰§è¡Œä¸€æ¡çº¿ç¨‹ä¸­çš„æŒ‡ä»¤ã€‚å› æ­¤ï¼Œä¸ºäº†çº¿ç¨‹åˆ‡æ¢ï¼ˆ<strong>ç³»ç»Ÿä¸Šä¸‹æ–‡åˆ‡æ¢</strong>ï¼‰åèƒ½æ¢å¤åˆ°æ­£ç¡®çš„æ‰§è¡Œä½ç½®ï¼Œæ¯æ¡çº¿ç¨‹éƒ½éœ€è¦æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ç¨‹åºè®¡æ•°å™¨ï¼Œå„æ¡çº¿ç¨‹ä¹‹é—´è®¡æ•°å™¨äº’ä¸å½±å“ï¼Œç‹¬ç«‹å­˜å‚¨ï¼Œæˆ‘ä»¬ç§°è¿™ç±»å†…å­˜åŒºåŸŸä¸ºâ€œçº¿ç¨‹ç§æœ‰â€çš„å†…å­˜ã€‚</p><p><strong>å­˜å‚¨çš„ä»€ä¹ˆæ•°æ®ï¼Ÿ</strong></p><p>å¦‚æœä¸€ä¸ªçº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„æ˜¯ä¸€ä¸ªJavaæ–¹æ³•ï¼Œè¿™ä¸ªè®¡æ•°å™¨è®°å½•çš„æ˜¯æ­£åœ¨æ‰§è¡Œçš„è™šæ‹Ÿæœºå­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€ï¼›å¦‚æœæ­£åœ¨æ‰§è¡Œçš„æ˜¯ä¸€ä¸ªNativeæ–¹æ³•ï¼Œè¿™ä¸ªè®¡æ•°å™¨çš„å€¼åˆ™ä¸ºç©ºã€‚</p><p><strong>å¼‚å¸¸ï¼š</strong><!----></p><h4 id="_1-3-7-ç›´æ¥å†…å­˜" tabindex="-1"><a class="header-anchor" href="#_1-3-7-ç›´æ¥å†…å­˜" aria-hidden="true">#</a> 1.3.7 ç›´æ¥å†…å­˜</h4><p>ç›´æ¥å†…å­˜å¹¶ä¸æ˜¯è™šæ‹Ÿæœºè¿è¡Œæ—¶æ•°æ®åŒºçš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿä¸æ˜¯Java è™šæ‹Ÿæœºè§„èŒƒä¸­å®šä¹‰çš„å†…å­˜åŒºåŸŸã€‚åœ¨JDK1.4 ä¸­æ–°åŠ å…¥äº†NIO(New Input/Output)ç±»ï¼Œå¼•å…¥äº†ä¸€ç§åŸºäºé€šé“(Channel)ä¸ç¼“å†²åŒºï¼ˆBufferï¼‰çš„I/O æ–¹å¼ï¼Œå®ƒå¯ä»¥ä½¿ç”¨native å‡½æ•°åº“ç›´æ¥åˆ†é…å †å¤–å†…å­˜ï¼Œç„¶åé€šè¿‡ä¸€ä¸ªå­˜å‚¨åœ¨Javaå †ä¸­çš„<strong>DirectByteBuffer</strong> å¯¹è±¡ä½œä¸ºè¿™å—å†…å­˜çš„å¼•ç”¨è¿›è¡Œæ“ä½œã€‚è¿™æ ·èƒ½åœ¨ä¸€äº›åœºæ™¯ä¸­æ˜¾è‘—æé«˜æ€§èƒ½ï¼Œå› ä¸ºé¿å…äº†åœ¨Javaå †å’ŒNativeå †ä¸­æ¥å›å¤åˆ¶æ•°æ®ã€‚</p><p>æœ¬æœºç›´æ¥å†…å­˜çš„åˆ†é…ä¸ä¼šå—åˆ°Java å †å¤§å°çš„é™åˆ¶ï¼Œå—åˆ°æœ¬æœºæ€»å†…å­˜å¤§å°é™åˆ¶ã€‚</p><p><strong>ç›´æ¥å†…å­˜ï¼ˆå †å¤–å†…å­˜ï¼‰ä¸å †å†…å­˜æ¯”è¾ƒï¼š</strong></p><ul><li>ç›´æ¥å†…å­˜ç”³è¯·ç©ºé—´è€—è´¹æ›´é«˜çš„æ€§èƒ½ï¼Œå½“é¢‘ç¹ç”³è¯·åˆ°ä¸€å®šé‡æ—¶å°¤ä¸ºæ˜æ˜¾</li><li>ç›´æ¥å†…å­˜IOè¯»å†™çš„æ€§èƒ½è¦ä¼˜äºæ™®é€šçš„å †å†…å­˜ï¼Œåœ¨å¤šæ¬¡è¯»å†™æ“ä½œçš„æƒ…å†µä¸‹å·®å¼‚æ˜æ˜¾</li></ul><h4 id="ç›´æ¥å†…å­˜æ¡ˆä¾‹" tabindex="-1"><a class="header-anchor" href="#ç›´æ¥å†…å­˜æ¡ˆä¾‹" aria-hidden="true">#</a> ç›´æ¥å†…å­˜æ¡ˆä¾‹ï¼š</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>hero<span class="token punctuation">.</span>jvm<span class="token punctuation">.</span>memory</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span></span><span class="token class-name">ByteBuffer</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ByteBufferCompare</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//allocateCompare();   //åˆ†é…æ¯”è¾ƒ</span>
        <span class="token function">operateCompare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">//è¯»å†™æ¯”è¾ƒ</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * ç›´æ¥å†…å­˜ å’Œ å †å†…å­˜çš„ åˆ†é…ç©ºé—´æ¯”è¾ƒ
     * ç»“è®ºï¼š åœ¨æ•°æ®é‡æå‡æ—¶ï¼Œç›´æ¥å†…å­˜ç›¸æ¯”éç›´æ¥å†…çš„ç”³è¯·ï¼Œæœ‰å¾ˆä¸¥é‡çš„æ€§èƒ½é—®é¢˜
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">allocateCompare</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> time <span class="token operator">=</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">10000</span><span class="token punctuation">;</span>    <span class="token comment">//æ“ä½œæ¬¡æ•°,1åƒä¸‡</span>
        <span class="token keyword">long</span> st <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> time<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token comment">//ByteBuffer.allocate(int capacity)   åˆ†é…ä¸€ä¸ªæ–°çš„å­—èŠ‚ç¼“å†²åŒºã€‚</span>
            <span class="token class-name">ByteBuffer</span> buffer <span class="token operator">=</span> <span class="token class-name">ByteBuffer</span><span class="token punctuation">.</span><span class="token function">allocate</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">//éç›´æ¥å†…å­˜åˆ†é…ç”³è¯·</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">long</span> et <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;åœ¨è¿›è¡Œ&quot;</span> <span class="token operator">+</span> time <span class="token operator">+</span> <span class="token string">&quot;æ¬¡åˆ†é…æ“ä½œæ—¶ï¼Œå †å†…å­˜ åˆ†é…è€—æ—¶:&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>et <span class="token operator">-</span> st<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;ms&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">long</span> st_heap <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> time<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//ByteBuffer.allocateDirect(int capacity) åˆ†é…æ–°çš„ç›´æ¥å­—èŠ‚ç¼“å†²åŒºã€‚</span>
            <span class="token class-name">ByteBuffer</span> buffer <span class="token operator">=</span> <span class="token class-name">ByteBuffer</span><span class="token punctuation">.</span><span class="token function">allocateDirect</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ç›´æ¥å†…å­˜åˆ†é…ç”³è¯·</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">long</span> et_direct <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;åœ¨è¿›è¡Œ&quot;</span> <span class="token operator">+</span> time <span class="token operator">+</span> <span class="token string">&quot;æ¬¡åˆ†é…æ“ä½œæ—¶ï¼Œç›´æ¥å†…å­˜ åˆ†é…è€—æ—¶:&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>et_direct <span class="token operator">-</span> st_heap<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;ms&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * ç›´æ¥å†…å­˜ å’Œ å †å†…å­˜çš„ è¯»å†™æ€§èƒ½æ¯”è¾ƒ
     * ç»“è®ºï¼šç›´æ¥å†…å­˜åœ¨ç›´æ¥çš„IO æ“ä½œä¸Šï¼Œåœ¨é¢‘ç¹çš„è¯»å†™æ—¶ ä¼šæœ‰æ˜¾è‘—çš„æ€§èƒ½æå‡
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">operateCompare</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> time <span class="token operator">=</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token number">10000</span> <span class="token operator">*</span> <span class="token number">10000</span><span class="token punctuation">;</span> <span class="token comment">//æ“ä½œæ¬¡æ•°,10äº¿</span>

        <span class="token class-name">ByteBuffer</span> buffer <span class="token operator">=</span> <span class="token class-name">ByteBuffer</span><span class="token punctuation">.</span><span class="token function">allocate</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> st <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> time<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//  putChar(char value) ç”¨æ¥å†™å…¥ char å€¼çš„ç›¸å¯¹ put æ–¹æ³•</span>
            buffer<span class="token punctuation">.</span><span class="token function">putChar</span><span class="token punctuation">(</span><span class="token char">&#39;a&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        buffer<span class="token punctuation">.</span><span class="token function">flip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> time<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            buffer<span class="token punctuation">.</span><span class="token function">getChar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">long</span> et <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;åœ¨è¿›è¡Œ&quot;</span> <span class="token operator">+</span> time <span class="token operator">+</span> <span class="token string">&quot;æ¬¡è¯»å†™æ“ä½œæ—¶ï¼Œéç›´æ¥å†…å­˜è¯»å†™è€—æ—¶ï¼š&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>et <span class="token operator">-</span> st<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;ms&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">ByteBuffer</span> buffer_d <span class="token operator">=</span> <span class="token class-name">ByteBuffer</span><span class="token punctuation">.</span><span class="token function">allocateDirect</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> st_direct <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> time<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//  putChar(char value) ç”¨æ¥å†™å…¥ char å€¼çš„ç›¸å¯¹ put æ–¹æ³•</span>
            buffer_d<span class="token punctuation">.</span><span class="token function">putChar</span><span class="token punctuation">(</span><span class="token char">&#39;a&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        buffer_d<span class="token punctuation">.</span><span class="token function">flip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> time<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            buffer_d<span class="token punctuation">.</span><span class="token function">getChar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">long</span> et_direct <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;åœ¨è¿›è¡Œ&quot;</span> <span class="token operator">+</span> time <span class="token operator">+</span> <span class="token string">&quot;æ¬¡è¯»å†™æ“ä½œæ—¶ï¼Œç›´æ¥å†…å­˜è¯»å†™è€—æ—¶:&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>et_direct <span class="token operator">-</span> st_direct<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;ms&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¾“å‡ºï¼š</p><ul><li>åœ¨è¿›è¡Œ10000000æ¬¡åˆ†é…æ“ä½œæ—¶ï¼Œ<strong>å †å†…å­˜</strong> åˆ†é…è€—æ—¶:82ms</li><li>åœ¨è¿›è¡Œ10000000æ¬¡åˆ†é…æ“ä½œæ—¶ï¼Œ<strong>ç›´æ¥å†…å­˜</strong> åˆ†é…è€—æ—¶:6817ms</li><li>åœ¨è¿›è¡Œ1000000000æ¬¡è¯»å†™æ“ä½œæ—¶ï¼Œ<strong>å †å†…å­˜</strong> è¯»å†™è€—æ—¶ï¼š1137ms</li><li>åœ¨è¿›è¡Œ1000000000æ¬¡è¯»å†™æ“ä½œæ—¶ï¼Œ<strong>ç›´æ¥å†…å­˜</strong> è¯»å†™è€—æ—¶:512ms</li></ul><p><strong>ä¸ºä»€ä¹ˆä¼šæ˜¯è¿™æ ·ï¼Ÿ</strong></p><p>ä»æ•°æ®æµçš„è§’åº¦ï¼Œæ¥çœ‹</p><ul><li>éç›´æ¥å†…å­˜ä½œç”¨é“¾ï¼šæœ¬åœ°IO â€“&gt;ç›´æ¥å†…å­˜â€“&gt;éç›´æ¥å†…å­˜â€“&gt;ç›´æ¥å†…å­˜â€“&gt;æœ¬åœ°IO</li><li>ç›´æ¥å†…å­˜ä½œç”¨é“¾ï¼šæœ¬åœ°IOâ€“&gt;ç›´æ¥å†…å­˜â€“&gt;æœ¬åœ°IO</li></ul><p><strong>ç›´æ¥å†…å­˜çš„ä½¿ç”¨åœºæ™¯ï¼š</strong></p><ul><li>æœ‰å¾ˆå¤§çš„æ•°æ®éœ€è¦å­˜å‚¨ï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸå¾ˆé•¿</li><li>é€‚åˆé¢‘ç¹çš„IOæ“ä½œï¼Œä¾‹å¦‚ï¼šç½‘ç»œå¹¶å‘åœºæ™¯</li></ul><h1 id="ä»Šæ—¥æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#ä»Šæ—¥æ€»ç»“" aria-hidden="true">#</a> ä»Šæ—¥æ€»ç»“</h1><h2 id="_01-jvmåŸºæœ¬å¸¸è¯†" tabindex="-1"><a class="header-anchor" href="#_01-jvmåŸºæœ¬å¸¸è¯†" aria-hidden="true">#</a> 01-JVMåŸºæœ¬å¸¸è¯†</h2><ul><li><strong>ä»€ä¹ˆæ˜¯JVMï¼Ÿ</strong> å¹¿ä¹‰ä¸Šçš„JVMæ˜¯æŒ‡ä¸€ç§è§„èŒƒï¼Œç‹­ä¹‰ä¸Šçš„JVMæŒ‡çš„æ˜¯Hotspotç±»çš„è™šæ‹Ÿæœºå®ç° å¹¿ä¹‰ä¸Šçš„JVMæ˜¯æŒ‡ä¸€ç§è§„èŒƒï¼Œç‹­ä¹‰ä¸Šçš„JVMæŒ‡çš„æ˜¯Hotspotç±»çš„è™šæ‹Ÿæœºå®ç°</li><li>Javaè¯­è¨€ä¸JVMçš„å…³ç³»ï¼šJavaè¯­è¨€ç¼–å†™ç¨‹åºç”Ÿæˆclasså­—èŠ‚ç åœ¨JVMè™šæ‹Ÿæœºé‡Œæ‰§è¡Œã€‚å…¶ä»–è¯­è¨€ä¹Ÿå¯ä»¥æ¯”å¦‚Scalaã€Groovy</li><li><strong>å­¦ä¹ JVMä¸»è¦å­¦å•¥ï¼Ÿ</strong> ç±»åŠ è½½å­ç³»ç»Ÿ --&gt; è¿è¡Œæ—¶æ•°æ®åŒº --&gt; ä¸€ä¸ªå¯¹è±¡çš„ä¸€ç”Ÿ--&gt; GCåƒåœ¾æ”¶é›†å™¨ ç±»åŠ è½½å­ç³»ç»Ÿ --&gt; è¿è¡Œæ—¶æ•°æ®åŒº --&gt; ä¸€ä¸ªå¯¹è±¡çš„ä¸€ç”Ÿ--&gt; GCåƒåœ¾æ”¶é›†å™¨</li><li><strong>å­¦äº†JVMå¯ä»¥å¹²å•¥ï¼Ÿ</strong> JVMè°ƒä¼˜ï¼Œåº•å±‚èƒ½åŠ› JVMè°ƒä¼˜ï¼Œåº•å±‚èƒ½åŠ›<strong>å†³å®š</strong> ä¸Šå±‚å»ºç­‘</li></ul><h2 id="_02-ç±»åŠ è½½å­ç³»ç»Ÿ" tabindex="-1"><a class="header-anchor" href="#_02-ç±»åŠ è½½å­ç³»ç»Ÿ" aria-hidden="true">#</a> 02-ç±»åŠ è½½å­ç³»ç»Ÿ</h2><ul><li><strong>ç±»åŠ è½½å››ä¸ªæ—¶æœºï¼š</strong> 1.newã€getstaticã€putstaticã€invokestaticã€‚2.åå°„ã€‚3.åˆå§‹åŒ–å­ç±»å‘ç°çˆ¶ç±»æ²¡æœ‰åˆå§‹åŒ–æ—¶ã€‚4.mainå‡½æ•°çš„ç±»</li><li><strong>ç±»åŠ è½½ä¸»è¦è¿‡ç¨‹ï¼š</strong> åŠ è½½ -&gt; éªŒè¯ -&gt; å‡†å¤‡ -&gt; è§£æ -&gt; åˆå§‹åŒ– -&gt; ä½¿ç”¨ -&gt; å¸è½½</li><li><strong>ç±»åŠ è½½ä¸»è¦åšäº†ä¸‰ä»¶äº‹ï¼š</strong><ul><li>å…¨é™å®šåç§° ==&gt; äºŒè¿›åˆ¶å­—èŠ‚æµåŠ è½½classæ–‡ä»¶</li><li>å­—èŠ‚æµçš„é™æ€æ•°æ®ç»“æ„ ==&gt; æ–¹æ³•åŒºçš„è¿è¡Œæ—¶æ•°æ®ç»“æ„</li><li>åˆ›å»ºå­—èŠ‚ç Classå¯¹è±¡</li></ul></li><li><strong>å¯ä»¥ä»å“ªäº›é€”å¾„åŠ è½½å­—èŠ‚ç ï¼š</strong><ul><li>Jarã€war</li><li>JSPç”Ÿæˆçš„class</li><li>æ•°æ®åº“ä¸­äºŒè¿›åˆ¶å­—èŠ‚æµ</li><li>ç½‘ç»œä¸­äºŒè¿›åˆ¶å­—èŠ‚æµ</li><li>åŠ¨æ€ä»£ç†ç”Ÿæˆçš„äºŒè¿›åˆ¶å­—èŠ‚æµ</li></ul></li><li><strong>ç±»åŠ è½½å™¨æœ‰å“ªäº›ï¼Ÿ</strong><ul><li>å¯åŠ¨ç±»åŠ è½½å™¨BootstrapClassLoaderï¼Œæ‰©å±•ç±»åŠ è½½å™¨ExtensionClassLoader</li><li>åº”ç”¨ç±»åŠ è½½å™¨ApplicationClassLoaderï¼Œè‡ªå®šä¹‰ç±»åŠ è½½å™¨UserClassLoader</li><li>æ£€æŸ¥é¡ºåºè‡ªåº•å‘ä¸Šï¼ŒåŠ è½½é¡ºåºè‡ªé¡¶å‘ä¸‹</li></ul></li><li><strong>ä»€ä¹ˆæ˜¯åŒäº²å§”æ´¾ï¼Ÿ</strong> å½“ä¸€ä¸ªç±»åŠ è½½å™¨æ”¶åˆ°åŠ è½½ä»»åŠ¡ï¼Œä¼šå…ˆäº¤ç»™å…¶çˆ¶ç±»åŠ è½½å™¨å»åŠ è½½ å½“ä¸€ä¸ªç±»åŠ è½½å™¨æ”¶åˆ°åŠ è½½ä»»åŠ¡ï¼Œä¼šå…ˆäº¤ç»™å…¶çˆ¶ç±»åŠ è½½å™¨å»åŠ è½½</li><li><strong>ä¸ºä½•è¦æ‰“ç ´åŒäº²å§”æ´¾ï¼Ÿ</strong> çˆ¶ç±»åŠ è½½å™¨åŠ è½½èŒƒå›´å—é™ï¼Œæ— æ³•åŠ è½½çš„ç±»éœ€è¦å§”æ‰˜å­ç±»åŠ è½½å™¨å»å®ŒæˆåŠ è½½ çˆ¶ç±»åŠ è½½å™¨åŠ è½½èŒƒå›´å—é™ï¼Œæ— æ³•åŠ è½½çš„ç±»éœ€è¦å§”æ‰˜å­ç±»åŠ è½½å™¨å»å®ŒæˆåŠ è½½</li></ul><h2 id="_03-è¿è¡Œæ—¶æ•°æ®åŒº" tabindex="-1"><a class="header-anchor" href="#_03-è¿è¡Œæ—¶æ•°æ®åŒº" aria-hidden="true">#</a> 03-è¿è¡Œæ—¶æ•°æ®åŒº</h2><ul><li><strong>å †ï¼š</strong> JVMå¯åŠ¨æ˜¯åˆ›å»ºçš„æœ€å¤§çš„ä¸€å—å†…å­˜åŒºåŸŸï¼Œå¯¹è±¡ï¼Œæ•°ç»„ï¼Œè¿è¡Œæ—¶å¸¸é‡æ± éƒ½åœ¨è¿™é‡Œ JVMå¯åŠ¨æ˜¯åˆ›å»ºçš„æœ€å¤§çš„ä¸€å—å†…å­˜åŒºåŸŸï¼Œå¯¹è±¡ï¼Œæ•°ç»„ï¼Œè¿è¡Œæ—¶å¸¸é‡æ± éƒ½åœ¨è¿™é‡Œ <ul><li>å†…å­˜åˆ’åˆ†ï¼šEdenã€2ä¸ªSurvivorã€è€å¹´ä»£</li><li><strong>ä¸ºä»€ä¹ˆè¦åˆ’åˆ†æ–°ç”Ÿä»£ä¸è€å¹´ä»£ï¼Ÿ</strong> åŸºäºåˆ†ä»£æ”¶é›†ç†è®ºé‡Œçš„é‡å¤§å‡è¯´ï¼Œå¼±åˆ†ä»£å’Œå¼ºåˆ†ä»£å‡è¯´ã€‚ åŸºäºåˆ†ä»£æ”¶é›†ç†è®ºé‡Œçš„é‡å¤§å‡è¯´ï¼Œå¼±åˆ†ä»£å’Œå¼ºåˆ†ä»£å‡è¯´ã€‚<strong>æå‡åƒåœ¾æ”¶é›†çš„æ•ˆç‡ã€‚</strong></li><li>å†…å­˜æ¨¡å‹å˜è¿å²ï¼šJDK1.7 ---å–æ¶ˆæ°¸ä¹…ä»£ï¼Œå¤šäº†å…ƒç©ºé—´---&gt; JDK1.8 ---å–æ¶ˆæ–°ç”Ÿä»£ä¸è€å¹´ä»£ç‰©ç†åˆ’åˆ†---&gt; JDK1.9</li></ul></li><li><strong>è™šæ‹Ÿæœºæ ˆï¼š</strong> æ ˆç©ºé—´ä¸ºçº¿ç¨‹ç§æœ‰ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½ä¼šåˆ›å»ºæ ˆå†…å­˜ï¼Œç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹ç›¸åŒ æ ˆç©ºé—´ä¸ºçº¿ç¨‹ç§æœ‰ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½ä¼šåˆ›å»ºæ ˆå†…å­˜ï¼Œç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹ç›¸åŒ <ul><li>çº¿ç¨‹å†…çš„æ ˆå†…å­˜å æ»¡äº†ä¼šå‡ºç°StackOverflowError</li><li><strong>æ ˆå¸§æ˜¯ä»€ä¹ˆï¼Ÿ</strong> <strong>æ ˆå¸§(Stack Frame)æ˜¯ç”¨äºæ”¯æŒè™šæ‹Ÿæœºè¿›è¡Œ</strong> <strong>æ–¹æ³•æ‰§è¡Œ</strong>çš„æ•°æ®ç»“æ„ã€‚</li></ul></li><li><strong>æœ¬åœ°æ–¹æ³•æ ˆï¼š</strong> ä¸è™šæ‹Ÿæœºæ ˆç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºæœ¬åœ°æ–¹æ³•æ ˆä¸ºæœ¬åœ°æ–¹æ³•æœåŠ¡ï¼Œä¹Ÿå°±æ˜¯nativeæ–¹æ³• ä¸è™šæ‹Ÿæœºæ ˆç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºæœ¬åœ°æ–¹æ³•æ ˆä¸ºæœ¬åœ°æ–¹æ³•æœåŠ¡ï¼Œä¹Ÿå°±æ˜¯nativeæ–¹æ³•</li><li><strong>æ–¹æ³•åŒºï¼š</strong> æ–¹æ³•åŒºçš„å®ç°æœ‰ä¸¤ç§ï¼šæ°¸ä¹…ä»£ï¼ˆPermGenï¼‰ã€å…ƒç©ºé—´ï¼ˆMetaspaceï¼‰ æ–¹æ³•åŒºçš„å®ç°æœ‰ä¸¤ç§ï¼šæ°¸ä¹…ä»£ï¼ˆPermGenï¼‰ã€å…ƒç©ºé—´ï¼ˆMetaspaceï¼‰ <ul><li><strong>æ–¹æ³•åŒºå­˜ä»€ä¹ˆæ•°æ®ï¼Ÿ</strong> ç±»å‹ä¿¡æ¯ï¼Œæ–¹æ³•ä¿¡æ¯ï¼Œå­—æ®µä¿¡æ¯ï¼Œç±»å˜é‡ä¿¡æ¯ï¼Œæ–¹æ³•è¡¨ï¼ŒæŒ‡å‘ç±»åŠ è½½å™¨çš„å¼•ç”¨ï¼ŒæŒ‡å‘Classå®ä¾‹çš„å¼•ç”¨ ç±»å‹ä¿¡æ¯ï¼Œæ–¹æ³•ä¿¡æ¯ï¼Œå­—æ®µä¿¡æ¯ï¼Œç±»å˜é‡ä¿¡æ¯ï¼Œæ–¹æ³•è¡¨ï¼ŒæŒ‡å‘ç±»åŠ è½½å™¨çš„å¼•ç”¨ï¼ŒæŒ‡å‘Classå®ä¾‹çš„å¼•ç”¨</li><li><strong>æ°¸ä¹…ä»£å’Œå…ƒç©ºé—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</strong><ul><li>å­˜å‚¨ä½ç½®ä¸åŒ</li><li>å­˜å‚¨å†…å®¹ä¸åŒ</li></ul></li><li><strong>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å…ƒç©ºé—´æ¥æ›¿æ¢æ°¸ä¹…ä»£ï¼Ÿ</strong><ul><li>åŸºäºæ€§èƒ½ã€ç¨³å®šæ€§ã€GCåƒåœ¾æ”¶é›†çš„å¤æ‚åº¦è€ƒè™‘ï¼Œå½“ç„¶ä¹Ÿæœ‰Oracleæ”¶è´­äº†JavaåŸå› </li></ul></li></ul></li><li><strong>å­—ç¬¦ä¸²å¸¸é‡æ± </strong><ul><li>ä¸‰ç§å¸¸é‡æ± ï¼šclasså¸¸é‡æ± ã€è¿è¡Œæ—¶å¸¸é‡æ± ã€å­—ç¬¦ä¸²å¸¸é‡æ± </li><li>**å­—ç¬¦ä¸²å¸¸é‡æ± å¦‚ä½•å­˜å‚¨æ•°æ®ï¼Ÿ**<strong>å­—ç¬¦ä¸²å¸¸é‡æ± å¦‚ä½•å­˜å‚¨æ•°æ®ï¼Ÿ</strong> ä½¿ç”¨å“ˆå¸Œè¡¨ã€å“ˆå¸Œå†²çªï¼Œå“ˆå¸Œç¢°æ’...ã€‘ ä½¿ç”¨å“ˆå¸Œè¡¨ã€å“ˆå¸Œå†²çªï¼Œå“ˆå¸Œç¢°æ’...ã€‘</li><li>**å­—ç¬¦ä¸²å¸¸é‡æ± å¦‚ä½•æŸ¥æ‰¾å­—ç¬¦ä¸²ï¼Ÿ**<strong>å­—ç¬¦ä¸²å¸¸é‡æ± å¦‚ä½•æŸ¥æ‰¾å­—ç¬¦ä¸²ï¼Ÿ</strong> ç±»ä¼¼äºHashMap ç±»ä¼¼äºHashMap</li></ul></li><li><strong>ç¨‹åºè®¡æ•°å™¨</strong><ul><li><strong>å­˜å‚¨ä»€ä¹ˆæ•°æ®ï¼Ÿ</strong> å½“å‰çº¿ç¨‹æ‰§è¡Œæ—¶çš„å­—èŠ‚ç æŒ‡ä»¤åœ°å€ å½“å‰çº¿ç¨‹æ‰§è¡Œæ—¶çš„å­—èŠ‚ç æŒ‡ä»¤åœ°å€</li><li>**ä¸ºä»€ä¹ˆéœ€è¦ç¨‹åºè®¡æ•°å™¨ï¼Ÿ**<strong>ä¸ºä»€ä¹ˆéœ€è¦ç¨‹åºè®¡æ•°å™¨ï¼Ÿ</strong> å› ä¸ºç³»ç»Ÿçš„ä¸Šä¸‹æ–‡åˆ‡æ¢ å› ä¸ºç³»ç»Ÿçš„ä¸Šä¸‹æ–‡åˆ‡æ¢</li></ul></li><li><strong>ç›´æ¥å†…å­˜</strong><ul><li>ç›¸å¯¹å †å†…å­˜ï¼Œç›´æ¥å†…å­˜ç”³è¯·ç©ºé—´æ›´è€—æ—¶</li><li>ç›´æ¥å†…å­˜IOè¯»å†™çš„æ€§èƒ½è¦ä¼˜äºæ™®é€šçš„å †å†…å­˜</li></ul></li></ul></div><!--[--><!----><!--]--><footer class="page-meta"><!----><div class="meta-item git-info"><div class="update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: lzc525@qq.com">lwx1095775</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a aria-label="01-JavaåŸºç¡€" class="vp-link nav-link prev nav-link prev" href="/lzc-blog.github.io/knowledge/01-Java/01-Java%E5%9F%BA%E7%A1%80%E9%83%A8%E5%88%86.html"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->01-JavaåŸºç¡€</div></a><a aria-label="06-å¹¶å‘ç¼–ç¨‹" class="vp-link nav-link next nav-link next" href="/lzc-blog.github.io/knowledge/01-Java/06-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B.html"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">06-å¹¶å‘ç¼–ç¨‹<!----></div></a></nav><!----><!--[--><!----><!--]--><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">ä¸»é¢˜ä½¿ç”¨ VuePress Theme Hope | å…³äºç½‘ç«™</div><div class="vp-copyright">Copyright Â© 2024 Mr.Lzc </div></footer></div><!--]--><!----><!--]--></div>
    <script type="module" src="/lzc-blog.github.io/assets/app-R2Im2jFX.js" defer></script>
  </body>
</html>
